(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3914:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>eR});var r=t(5155);let s=function(){for(var e,n,t=0,r="",s=arguments.length;t<s;t++)(e=arguments[t])&&(n=function e(n){var t,r,s="";if("string"==typeof n||"number"==typeof n)s+=n;else if("object"==typeof n)if(Array.isArray(n)){var o=n.length;for(t=0;t<o;t++)n[t]&&(r=e(n[t]))&&(s&&(s+=" "),s+=r)}else for(r in n)n[r]&&(s&&(s+=" "),s+=r);return s}(e))&&(r&&(r+=" "),r+=n);return r};function o(e){let{name:n,options:t}=e;return(0,r.jsxs)("div",{className:"border-b-1 border-solid border-zinc-400 px-2 flex bg-black",children:[(0,r.jsx)("span",{className:"mr-auto font-bold",children:n}),t&&Object.keys(t).map(e=>(0,r.jsx)("input",{type:"button",className:"my-auto mx-2 cursor-pointer hover",value:e,onClick:t[e]},e))]})}function i(e){let{name:n,headerOptions:t,className:i,children:a}=e;return(0,r.jsxs)("section",{className:s("grid grid-rows-[24px_1fr]",i),children:[(0,r.jsx)(o,{name:n,options:t}),a]})}function a(){return(0,r.jsx)("div",{className:"p3 overflow-y-scroll select-text",children:"Coming soon!"})}function c(){return(0,r.jsx)(i,{name:"Docs",className:"row-span-2 w-(--width1) border-r-1 border-solid border-zinc-400",children:(0,r.jsx)(a,{})})}function l(e){let{deep:n,arrow:t,name:s,childsElement:o,...i}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex",style:{marginLeft:8*n},children:[t,(0,r.jsx)("div",{className:"cursor-pointer hover",...i,children:s})]}),o]})}var u=t(2115);function d(){let e=(0,u.useState)(!1)[1];return()=>e(e=>!e)}class f{bind(e){if(e){let n=d();this.refresh=()=>{e(),n()}}else this.refresh=d()}get value(){return this.v}set value(e){var n;this.v=e,null==(n=this.refresh)||n.call(this)}constructor(e){this.refresh=()=>{throw Error("Refresh not bind!")},this.v=e}}function m(e){return new f(e)}function h(e,n){var t;let r=(t=new f(e),(0,u.useState)(t)[0]);return r.bind(n),r}function p(e){return JSON.parse(JSON.stringify(e))}function x(e){let{name:n,...t}=e,r=document.createElement(n);for(let e in t)r[e]=t[e];r.click()}function v(e,n){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];x({name:"a",href:"data:text;charset=utf-8,".concat(t?encodeURIComponent(n):n),download:e})}function b(e){return S.toUpperCase().includes(e[0])}function j(e){if(0===e.length||!b(e))return!1;for(let n=1;n<e.length;n++)if(!R.includes(e[n].toLowerCase()))return!1;return!0}function y(e){return A.includes(e)}function w(e){return!b(e)&&!y(e)}function g(){let e;H.value=!0;let n=D.value;for(e of L.pathToMainScene.split(".").slice(1))n=n[e];if(!e)throw Error("No main scene!");M.value=n}function k(){let{position:e,rotation:n,scale:t,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(r).reduce((e,n)=>({[n]:r[n],...e}),{type:"gameObject",transform:{position:e||{x:0,y:0},rotation:n||{z:0},scale:t||{x:1,y:1}}})}function N(e){return 0===e.length||e[0]===e[0].toUpperCase()?e:"".concat(e[0].toUpperCase()).concat(e.slice(1))}function O(e,n){for(let n in e)delete e[n];for(let t in n)e[t]=n[t]}function C(){x({name:"input",type:"file",accept:".virginengine",onchange:e=>{let{target:n}=e,t=new FileReader;t.onload=e=>{let{target:n}=e,t=JSON.parse(n.result);O(L,t.config),O(D.value,t.files),g()},t.readAsText(n.files[0])}})}function E(e){return"string"!=typeof e?typeof e:Array.isArray(e)||"["===e[0]?"array":"{"===e[0]?"object":0===e.indexOf("function")?"function":(['"',"'","`"].includes(e[0]),"string")}let S="abcdefghijklmnoprqstuwxyz",T="0123456789",R="".concat(S).concat(T,"_"),A=["type","transform","position","rotation","scale","text","rect","sprite","camera"],L={gameName:"Name of Game",version:"0.0.0",author:"Your Name or Nick",description:"Write what game is",fullScreen:!1,pathToMainScene:"files.Scenes.DefaultScene"},z={type:"folder",Scenes:{type:"folder",MenuScene:{type:"scene",name:"MenuScene"},MainScene:{type:"scene",name:"MainScene"},DefaultScene:{name:"DefaultScene",type:"scene",Parent:k({start:"function() {\n  for(let i = 0; i < 10; i++)\n    setTimeout(() => clone(this.parent.Child, scene))\n}"}),Child:k({scale:{x:20,y:20},sprite:{color:"red",imagePath:""},start:'function() {\n  this.position = {x: Math.random() * 1000, y: Math.random() * window.innerHeight}\n  console.log("Start ".concat(this.position.x))\n}',update:"function() { console.log(this.position.x, this.name) }"})}},Assets:{type:"folder",TempImage:{type:"image",value:{src:"data:image/png;base64",width:1,height:1}}}},M=m(z.Scenes.MainScene),_=m(null),P=m([]),G=m(null),F=m(""),D=m(z),U=m([]),H=m(!1);function Y(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=h(e);return[n?(0,r.jsx)("div",{className:"w-6 h-6 text-center justify-self-center rounded-full cursor-pointer hover",style:{transform:"rotate(".concat(90*!!t.value,"deg)")},onClick:()=>t.value=!t.value,children:">"}):(0,r.jsx)("div",{className:"w-6 h-6"}),t]}function X(){let e=(0,u.useState)(!1)[1];return()=>e(e=>!e)}function B(e){let{object:n,access:t,refresh:s}=e;return(0,r.jsx)("input",{type:"checkbox",className:"h-5 my-auto mr-auto aspect-square accent-green-500 cursor-pointer",checked:n[t],style:{opacity:.2*!n[t]},onChange:e=>{let{target:r}=e;n[t]=r.checked,s()}})}function K(e){let{object:n,access:t}=e,s=h(n[t],()=>n[t]=s.value);return(0,r.jsx)("input",{type:"text",className:"w-full border-b-1 border-solid border-zinc-400",value:s.value,onChange:e=>{let{target:{value:n}}=e;if(n.slice(1).includes("-"))return;let t=!1;for(let e of n){if(!"".concat(T,"-.").includes(e))return;if("."===e){if(t)return;t=!0}}let r=Number(n);"."!==n.at(-1)&&(r||0===r)&&(s.value=r)}})}function I(e){let{object:n,access:t}=e,s=h(n[t],()=>n[t]=s.value);return(0,r.jsx)("input",{type:"text",className:"w-full border-b-1 border-solid border-zinc-400",value:s.value,onChange:e=>{let{target:n}=e;return s.value=n.value}})}function J(e){var n;let t=X(),[s,o]=function(e){let n=e.type||E(e.object[e.access]),t=null;switch(n){case"boolean":t=(0,r.jsx)(B,{...e});break;case"number":t=(0,r.jsx)(K,{...e});break;case"string":t=(0,r.jsx)(I,{...e});break;case"array":case"object":case"function":t=null;break;case"enum":console.log("ENUM");break;default:throw Error("No such type!")}return[t,n]}({...e,refresh:t});return(0,r.jsxs)("div",{className:"w-full grid grid-cols-[auto_1fr] gap-3",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("span",{children:(n=e.access).slice(1).split("").reduce((e,n)=>"".concat(e).concat(n===n.toUpperCase()?" ":"").concat(n),n[0].toUpperCase())}),(0,r.jsxs)("span",{className:"text-green-500",children:[": ",o]}),(0,r.jsx)("span",{children:"="})]}),s]})}function Z(e){let{text:n,remove:t,childs:s,element:o}=e;return(0,r.jsxs)("div",{className:"mt-4 border-b-2 border-solid border-zinc-950 pb-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("h2",{className:"mb-2 border-l-4 border-solid border-zinc-800 pl-2 text-2xl font-bold",children:n}),t?(0,r.jsx)("input",{type:"button",value:"Remove",className:"mr-4 ml-auto cursor-pointer hover",onClick:t}):null]}),null==s?void 0:s.map(e=>(0,r.jsx)(J,{...e},e.access)),o]})}function q(e){var n;let{object:t,access:s}=e,o=(n=E(t[s]),(0,u.useState)(n)[0]);return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("div",{children:s}),(0,r.jsxs)("div",{className:"text-green-500",children:[": ",o]}),(0,r.jsx)("div",{children:"="})]}),(0,r.jsx)($,{object:t,access:s})]})}function $(e){var n;let{object:t,access:s}=e,o=(0,u.useRef)(null),i=X();return(0,u.useEffect)(i,[o]),(0,r.jsx)("textarea",{ref:o,className:"w-full resize-none",style:{height:null==o||null==(n=o.current)?void 0:n.scrollHeight},value:t[s],onChange:e=>{let{target:n}=e;t[s]=n.value,i()}})}let W={boolean:[!1,J],number:[0,J],string:['""',J],array:['[12, 43, "foo"]',q,"[","]"],object:["{}",q,"{","}"],function:["function() {}",q,"function(",") {","}"]};function Q(e){let{object:n,value:t,refresh:s}=e;return(0,r.jsx)(et,{text:N(t),onClick:()=>P.value=[e=>{!function(e,n){for(let t in e)if(t===n)return!0;return!1}(n,e)&&(n[e]=W[t][0],s())},"",!0]})}function V(e){let{object:n,refresh:t}=e;return(0,r.jsxs)(r.Fragment,{children:[Object.keys(n).filter(e=>w(e)).map(e=>(0,r.jsx)(Z,{text:e,element:W[E(n[e])][1]({object:n,access:e}),remove:()=>{delete n[e],t()}},e)),(0,r.jsx)("div",{className:"mb-4 flex flex-wrap",children:Object.keys(W).map(e=>(0,r.jsx)(Q,{value:e,object:n,refresh:t},e))})]})}function ee(e){let{object:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Z,{text:"Position",childs:[{object:n.transform.position,access:"x"},{object:n.transform.position,access:"y"}]}),(0,r.jsx)(Z,{text:"Rotation",childs:[{object:n.transform.rotation,access:"z"}]}),(0,r.jsx)(Z,{text:"Scale",childs:[{object:n.transform.scale,access:"x"},{object:n.transform.scale,access:"y"}]})]})}let en={text:[[["value"]],{value:""},["rect"],[]],rect:[[["x"],["y"]],{x:0,y:0},[],["text"]],sprite:[[["color"],["imagePath"]],{color:"",imagePath:""},[],[]]};function et(e){let{text:n,onClick:t}=e;return(0,r.jsx)("input",{type:"button",value:"+ ".concat(n),className:"mt-3 mb-6 px-3 py-2 cursor-pointer hover",onClick:t})}function er(e){var n;let{name:t,refresh:s,readOnly:o,...i}=e;return i.object[t]?(0,r.jsx)(Z,{text:N(t),childs:(n=i.object,en[t][0].reduce((e,r)=>[...e,{object:r.slice(0,-1).reduce((e,n)=>e[n],n[t]),access:r.at(-1)}],[])),...i,remove:o?void 0:()=>{for(let e of en[t][3])delete i.object[e];delete i.object[t],s()}},t):(0,r.jsx)(et,{text:N(t),onClick:()=>{if(!o){for(let e of(i.object[t]=p(en[t][1]),en[t][2]))i.object[e]||(i.object[e]=p(en[e][1]));s()}}})}function es(e){let{name:n,...t}=e,s=X();return t={...t,refresh:s},(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"ml-3 text-xl font-bold",children:n}),(0,r.jsx)(ee,{object:t.object}),Object.keys(en).map(e=>(0,u.createElement)(er,{...t,key:e,name:e})),(0,r.jsx)(V,{object:t.object,refresh:s})]},JSON.stringify(t))}function eo(e){var n;let{old:t,name:s,object:o,deep:i=0}=e,a=0===i,c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((n,t)=>!y(t)&&b(t)?{[t]:e[t],...n}:n,{})}(o),[u,d]=Y(a,(null==(n=Object.keys(c))?void 0:n.length)>0),f=d.value&&Object.entries(c).map(e=>{let[n,t]=e;return(0,r.jsx)(eo,{old:o,object:t,name:n,deep:i+1},n)});return l({deep:i,name:s,arrow:u,childsElement:f,onClick:()=>{var e;return!a&&(e={old:t,object:o,name:s},void(_.value=(0,r.jsx)(es,{...e})))},onContextMenu:e=>{let{pageX:n,pageY:r}=e;U.value=[n,r,[()=>{P.value=[e=>{Object.keys(o).includes(e)||(o[e]=k(),d.value=!0,M.refresh())}]},"New Object"],[()=>{P.value=[e=>{s===e||t[e]||(delete t[s],t[e]=o,M.refresh())},s]},"Rename",!a],[()=>{delete t[s],M.refresh()},"Delete",!a]]},onMouseDown:()=>{a||(G.value={from:"hierarchy",old:t,file:o,name:s})},onMouseUp:()=>{let e=G.value;if(e&&e.name!==s&&"gameObject"===e.file.type){for(let n in c)if(n===e.name)return;o[e.name]=e.file,"hierarchy"===e.from&&e.old&&delete e.old[e.name],M.refresh()}}})}function ei(){return M.bind(()=>_.value=null),(0,r.jsx)(eo,{object:M.value,old:D.value.Scenes,name:M.value.name,deep:0})}function ea(){return(0,r.jsx)(i,{name:"Hierarchy",className:"w-(--width2) h-(--height1) border-b-1 border-solid border-zinc-400",children:(0,r.jsx)("div",{className:"overflow-y-scroll",children:(0,r.jsx)(ei,{})})})}function ec(e){return e.replaceAll("\n"," ").replaceAll(/\s{2,}/g," ").replaceAll("> ",">").replaceAll(" <","<").replaceAll("; ",";").replaceAll(" {","{").replaceAll("{ ","{").replaceAll(' "','"').replaceAll('" ','"')}function el(){return"".concat(ec('\n<!DOCTYPE html>\n<html lang="en">\n  <head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width,initial-scale=1.0">\n    <meta name="author" content="'.concat(L.author,'">\n    <meta name="description" content="').concat(L.description,'">\n    <meta name="keywords" content="').concat(L.gameName,",").concat(L.author,'">\n\n    <title>').concat(L.gameName,'</title>\n\n  </head>\n  <body style="\n    background-color:black;\n    margin:0;\n    border:0;\n    padding:0;\n    user-select:none;\n    width:100vw;\n    height:100vh;\n    overflow:hidden;">\n\n    <canvas></canvas>\n    <script>\n      '))).concat('const ctx = document.body.children[0].getContext(`2d`)\nfunction onresize() {\nctx.canvas.width = window.innerWidth\nctx.canvas.height = window.innerHeight\n}\nwindow.addEventListener(`resize`, onresize)\nonresize()\nconst files = `REPLACE_FILES`\nlet scene = {}\nconst events = {}\nconst eventsHover = {}\nwindow.addEventListener(`mousedown`, () => (eventsHover.click = true))\nwindow.addEventListener(`mouseup`, () => delete eventsHover.click)\nwindow.addEventListener(`click`, () => (events.click = true))\nwindow.addEventListener(`keydown`, ({ key }) => (events[key] = eventsHover[key] = true))\nwindow.addEventListener(`keyup`, ({ key }) => delete eventsHover[key])\nwindow.addEventListener(`contextmenu`, (e) => {\ne.preventDefault()\n!document.fullscreenElement ? document.documentElement.requestFullscreen() : document.exitFullscreen()\n})\nconst GameTime = {\nms: 1,\nvalue: 1,\nlastTime: 0,\nget() {\nreturn GameTime.value\n},\nset(newTime) {\nGameTime.value = newTime\nGameTime.ms = 1000 / (60 * GameTime.value)\nGameTime.lastTime = performance.now()\n},\n}\nconst Log = { updates: 0, frames: 0, framesTemp: 0 }\nconst gameObjects = []\nclass GameObject {\ntoUpdate = []\ntoRender = []\nconstructor({ parent, transform, rect, text, sprite, start, update, render, ...rest }) {\nif (parent) this.parent = parent\nthis.transform = new Transform(transform, this)\nif (text) this.text = new Text(text, this, rect)\nif (sprite) this.sprite = new Sprite(sprite, this)\nfor (const key in rest) {\nif (isChildKey(key)) {\nthis[key] = new GameObject({ ...rest[key], parent: this })\n} else {\nthis[key] = typeof rest[key] === `function` ? rest[key].bind(this) : rest[key]\n}\n}\nif (update) this.toUpdate.push(update.bind(this))\nif (render) this.toRender.push(render.bind(this))\nif (start) {\nthis.start = start.bind(this)\nthis.start()\n}\ngameObjects.push(this)\n}\nget childs() {\nconst childs = []\nfor (const key in this) {\nif (isChildKey(key)) childs.push(this[key])\n}\nreturn childs\n}\nget name() {\nfor (const key in this.parent) {\nif (this === this.parent[key]) return key\n}\n}\nget props() {\nconst newObj = {\nstart: this?.start,\nupdate: this?.update,\ntransform: {\nposition: this.position,\nrotation: this.rotation,\nscale: this.scale,\n},\n}\nreturn deepCopy(newObj)\n}\nstatic destroy(obj) {\nfor (const child of obj.childs) GameObject.destroy(child)\nconst { parent } = obj\nlet parentKey = ``\nfor (const key in obj.parent) {\nif (obj.parent[key] === obj) {\nparentKey = key\nbreak\n}\n}\nfor (const key in obj) delete obj[key]\ngameObjects.splice(gameObjects.indexOf(obj))\ndelete parent[parentKey]\n}\n}\nclass Transform {\ngameObject = null\npositionX = 0\npositionY = 0\nrotationZ = 0\nscaleX = 1\nscaleY = 1\nconstructor(props, gameObject) {\nif (props) {\nthis.gameObject = gameObject\nconst { position, rotation, scale, rect } = props\nif (rect) this.rect = rect\nthis.position = position\nthis.rotation = rotation\nthis.scale = scale\ngameObject.position = position\ngameObject.rotation = rotation\ngameObject.scale = scale\n} else {\nthis.readOnly = true\n}\n}\nget position() {\nreturn { x: this.positionX, y: this.positionY }\n}\nset position({ x, y }) {\nif (this.readOnly) {\nalert(`PROGRAMMER, you can\'t chage "readOnly" position`)\nreturn\n}\nfor (const child of this.gameObject.childs) {\nchild.transform.position = {\nx: child.transform.positionX - this.positionX + x,\ny: child.transform.positionY - this.positionY + y,\n}\n}\nthis.positionX = x\nthis.positionY = y\n}\nget rotation() {\nreturn { z: this.rotationZ }\n}\nset rotation({ z }) {\nif (this.readOnly) {\nalert(`PROGRAMMER, you can\'t chage "readOnly" rotation`)\nreturn\n}\nwhile (z < 0) {\nz += 360\n}\nwhile (z > 360) {\nz -= 360\n}\nfor (const child of this.gameObject.childs) {\nlet newRot = child.transform.rotationZ - this.rotationZ + z\nif (newRot < 0) {\nnewRot += 360\n} else if (newRot > 360) {\nnewRot -= 360\n}\nchild.transform.rotation = { z: newRot }\n}\nthis.rotationZ = z\n}\nget scale() {\nreturn { x: this.scaleX, y: this.scaleY }\n}\nset scale({ x, y }) {\nif (this.readOnly) {\nalert(`PROGRAMMER, you can\'t chage "readOnly" scale`)\nreturn\n}\nfor (const child of this.gameObject.childs) {\nchild.transform.scale = {\nx: (child.transform.scaleX / this.scaleX) * x,\ny: (child.transform.scaleY / this.scaleY) * y,\n}\n}\nthis.scaleX = x\nthis.scaleY = y\n}\n}\nclass Collider {\nconstructor() {}\n}\nclass Physics {\nconstructor() {}\n}\nclass Sprite {\nconstructor({ color }, gameObject) {\nthis.gameObject = gameObject\nthis.color = color\ngameObject.toRender.push(this.render.bind(this))\n}\nrender() {\ndraw({\nx: this.gameObject.position.x,\ny: this.gameObject.position.y,\nw: this.gameObject.scale.x,\nh: this.gameObject.scale.y,\ncolor: this.color,\n})\n}\n}\nclass Animation {\nconstructor() {}\n}\nclass Text {\nvalue = ``\nrect = undefined\ntransform = undefined\nconstructor({ value }, gameObject, rect) {\nthis.transform = gameObject.transform\nthis.value = value\nthis.textBaseline = Text.textBaseline[rect.x]\nthis.textAlign = Text.textAlign[rect.y]\ngameObject.toRender.push(this.render.bind(this))\n}\nrender() {\ndraw({\ntext: this.value,\n...this.transform.position,\nfillStyle: `white`,\nfont: `${this.transform.scale.y}px serif`,\ntextBaseline: this.textBaseline,\ntextAlign: this.textAlign,\n})\n}\nstatic textBaseline = [`top`, `middle`, `bottom`]\nstatic textAlign = [`left`, `center`, `right`]\n}\nasync function wait(time) {\nawait new Promise((r) => setTimeout(r, time))\n}\nasync function wait0() {\nawait new Promise((r) => setTimeout(r))\n}\nfunction isChildKey(text) {\nreturn `ABCDEFGHIJKLMNOPRQSTUWXYZ`.includes(text[0])\n}\nfunction deepCopy(data) {\nif (Array.isArray(data)) {\nreturn data.reduce((prev, val) => [...prev, deepCopy(val)], [])\n}\nif (typeof data === `object`) {\nconst newObj = {}\nfor (const key in data) {\nnewObj[key] = deepCopy(data[key])\n}\nreturn newObj\n}\nreturn data\n}\nfunction clone(obj, parent) {\nconst name = obj.name\nlet newName = name\nlet i = 0\nwhile (parent[newName]) {\nnewName = `${name}${i}`\ni++\n}\nparent[newName] = new GameObject({ ...obj.props, parent })\n}\nfunction loadScene({ name, ...newScene }) {\ngameObjects.length = 0\nscene = new GameObject(deepCopy(newScene))\nscene.name = name\nfor (const key in events) delete events[key]\nfor (const key in eventsHover) delete eventsHover[key]\n}\nfunction draw({ text, color, x, y, w, h, ...props }) {\nctx.save()\nfor (const key in props) {\nctx[key] = props[key]\n}\nif (text) ctx.fillText(text, x, y)\nif (color) {\nctx.fillStyle = color\nctx.fillRect(x, y, w, h)\n}\nctx.restore()\n}\nfunction drawBoxMiddle(x, y, w, h, color) {\nif (color) ctx.fillStyle = color\nctx.fillRect(x, y, w, h)\n}\nasync function run() {\nGameTime.set(1)\nrequestAnimationFrame(render)\nlet timer = performance.now()\nlet updates = 0\nlet delta = 0\nwhile (true) {\nconst now = performance.now()\ndelta += (now - GameTime.lastTime) / GameTime.ms\nif (delta > 60) delta = 60\nGameTime.lastTime = now\nwhile (delta >= 1) {\nupdate()\nupdates++\ndelta--\n}\nif (now - timer > 1000) {\ntimer += 1000\nLog.updates = updates\nLog.frames = Log.framesTemp\nupdates = 0\nLog.framesTemp = 0\n}\nawait wait0()\n}\n}\nfunction update() {\nfor (const obj of gameObjects) {\nfor (const f of obj.toUpdate) f()\n}\nfor (const key in events) delete events[key]\n}\nfunction render() {\nctx.fillStyle = `black`\nctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)\nfor (const obj of gameObjects) {\nfor (const f of obj.toRender) f()\n}\nconst props = {\nx: 8,\ny: 8,\nfillStyle: `white`,\nfont: `22px serif`,\ntextAlign: `left`,\ntextBaseline: `top`,\n}\ndraw({ text: `Update ${Log.updates}`, ...props })\ndraw({ text: `Render ${Log.frames}`, ...props, y: 38 })\nLog.framesTemp++\nrequestAnimationFrame(render)\n}\nloadScene(`REPLACE_PATH_TO_MAIN_SCENE`)\nrun()'.replace("`REPLACE_FILES`",function e(n,t,r){return Array.isArray(n)?"".concat(n.reduce((n,t)=>"".concat(n).concat(e(t),","),"[").slice(0,-1),"]"):"object"==typeof n?"".concat(Object.keys(n).reduce((t,r)=>"".concat(t).concat(r,":").concat(e(n[r],r,n.type),","),"{").slice(0,-1),"}"):"gameObject"===r&&w(t)?n:JSON.stringify(n)}(D.value)).replace("`REPLACE_PATH_TO_MAIN_SCENE`",L.pathToMainScene)).concat(ec("\n    <\/script>\n  </body>\n</html>\n"))}function eu(){F.value=el()}function ed(){v("".concat(L.gameName,".virginengine"),JSON.stringify({config:L,files:D.value}))}function ef(){return(0,r.jsx)(Z,{text:"Config",childs:Object.keys(L).filter(e=>"type"!==e).map(e=>({text:e,object:L,access:e}))})}window.addEventListener("keydown",e=>{e.ctrlKey&&"s"===e.key&&(e.preventDefault(),ed())});let em={Test:eu,Save:ed,Build:function(){v("".concat(L.gameName,".html"),el(),!0)},Load:C,Config:()=>_.value=(0,r.jsx)(ef,{})};function eh(){return _.bind(),_.value}function ep(){return(0,r.jsx)(i,{name:"Inspenctor",className:"row-span-2 w-(--width3) border-l-1 border-solid border-zinc-400",headerOptions:em,children:(0,r.jsx)("div",{className:"p-2 overflow-y-scroll",children:(0,r.jsx)(eh,{})})})}function ex(e){let{old:n,file:t,name:s,deep:o=0,path:i="files"}=e,a=0===o;a||(i+=".".concat(s));let c="folder"===t.type,[u,d]=Y(a,c),f=d.value&&"scene"!==t.type&&Object.entries(t).map(e=>{let[n,s]=e;return b(n)&&(0,r.jsx)(ex,{old:t,file:s,name:n,deep:o+1,path:i},n)});return l({deep:o,name:s,arrow:u,childsElement:f,onClick:()=>{_.value=(0,r.jsxs)("div",{className:"m-3",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"File"}),(0,r.jsxs)("div",{children:["Type: ",t.type]}),(0,r.jsxs)("div",{children:["Name: ",s]})]})},onContextMenu:e=>{let{pageX:r,pageY:o}=e,l=(e,n)=>[()=>P.value=[e=>{t[e]={type:n},d.value=!0,D.refresh()}],e,c];U.value=[r,o,l("New file","txt"),l("New folder","folder"),l("New scene","scene"),[()=>P.value=[e=>{s!==e&&(delete n[s],n[e]=t,D.refresh())},s],"Rename",!a],[()=>navigator.clipboard.writeText(i),"Copy path"],[()=>{delete n[s],D.refresh()},"Delete",!a]]},onMouseDown:()=>{a||(G.value={from:"files",old:n,file:t,name:s})},onMouseUp:()=>{if(!c)return;let e=G.value;(null==e?void 0:e.from)!=="files"||e.name===s||t[e.name]||(t[e.name]=e.file,e.old&&delete e.old[e.name],D.refresh())},onDoubleClick:()=>"scene"===t.type&&void(M.value=t)})}let ev=()=>(D.bind(),(0,r.jsx)(ex,{file:D.value,name:"files",deep:0,old:!0}));function eb(){return(0,r.jsx)(i,{name:"Files",className:"w-(--width2) h-(--height2)",children:(0,r.jsx)("div",{className:"overflow-y-scroll",children:(0,r.jsx)(ev,{})})})}function ej(e){return(0,r.jsx)("input",{className:"mx-auto my-6 border-4 border-solid border-zinc-400 px-16 py-4 text-5xl cursor-pointer hover",type:"button",...e})}function ey(){return H.bind(),H.value?null:(0,r.jsxs)("div",{className:"absolute z-1 w-screen h-screen flex flex-col justify-center bg-[#000a]",children:[(0,r.jsx)(ej,{value:"Load Project",onClick:()=>C()}),(0,r.jsx)(ej,{value:"New project",onClick:g})]})}function ew(){let e=(0,u.useRef)(null);return U.bind(),(0,u.useEffect)(()=>{function n(n){let{target:t}=n;e.current&&!e.current.contains(t)&&(U.value=[])}return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[e]),U.value.length>2?(0,r.jsx)("div",{ref:e,className:"absolute z-1 border-4 border-solid border-zinc-800 px-2 py-0.5",style:{inset:"".concat(U.value[1],"px auto auto ").concat(U.value[0],"px")},children:U.value.slice(2).map(e=>{let[n,t,s=!0]=e;return s?(0,r.jsx)("div",{className:"cursor-pointer hover",onClick:()=>{n(),U.value=[]},children:t},t):null})}):null}function eg(){let e=(0,u.useRef)(null),n=function(e){P.bind();let[n,t="",r=!1]=P.value,s=()=>{n&&j(t)&&n(r?"".concat(t[0].toLowerCase()).concat(t.slice(1)):t),P.value=[]};return(0,u.useEffect)(()=>{if(e)return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n);function n(n){let{target:t}=n;e.current&&!e.current.contains(t)&&s()}}),n?{value:t,onChange:e=>{let{target:t}=e,s=N(t.value);j(s)&&(P.value=[n,s,r])},onKeyDown:e=>{let{key:n}=e;return"Enter"===n&&s()}}:null}(e);return n&&(0,r.jsx)("input",{ref:e,type:"text",className:"absolute z-1 text-4xl translate-x-[calc(50vw-50%)] translate-y-[calc(50vh-50%)]",...n,autoFocus:!0})}let ek=m(void 0);function eN(e){let{clientX:n,clientY:t}=e;ek.value={left:n+3,top:t+3}}function eO(){G.value=null,ek.value=void 0}function eC(){var e;return G.bind(),ek.bind(),(0,u.useEffect)(()=>{if(G.value)return window.addEventListener("mousemove",eN),window.addEventListener("mouseup",eO),()=>{window.removeEventListener("mousemove",eN),window.removeEventListener("mouseup",eO)}}),ek.value?(0,r.jsx)("div",{className:"absolute z-1 bg-[#000a]",style:ek.value,children:null==(e=G.value)?void 0:e.name}):null}let eE=["16 / 9","1 / 1","9 / 16"],eS=m(eE[0]);function eT(){if(F.bind(console.clear),eS.bind(),F.value)return(0,r.jsx)(i,{name:"Test",className:"absolute z-1 w-screen h-screen",headerOptions:{...eE.reduce((e,n)=>({...e,[n]:()=>eS.value=n}),{}),Restart:eu,Exit:()=>F.value=""},children:(0,r.jsx)("div",{className:"flex justify-center bg-zinc-950",children:(0,r.jsx)("iframe",{title:"scene",className:"border-x-1 border-solid border-zinc-400",style:{height:"min(100%, 100vw * ".concat(eS.value,")"),aspectRatio:eS.value},srcDoc:F.value})})})}function eR(){if(function(){let[e,n]=(0,u.useState)(!1);return(0,u.useEffect)(()=>n(!0),[e]),e}())return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{children:[(0,r.jsx)(ey,{}),(0,r.jsx)(ew,{}),(0,r.jsx)(eg,{}),(0,r.jsx)(eC,{}),(0,r.jsx)(eT,{})]}),(0,r.jsxs)("main",{className:"w-screen h-screen grid grid-cols-[30fr_30fr_40fr] grid-rows-[55fr_45fr]",children:[(0,r.jsx)(c,{}),(0,r.jsx)(ea,{}),(0,r.jsx)(ep,{}),(0,r.jsx)(eb,{})]})]})}},6928:(e,n,t)=>{Promise.resolve().then(t.bind(t,3914))}},e=>{var n=n=>e(e.s=n);e.O(0,[441,684,358],()=>n(6928)),_N_E=e.O()}]);