(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6928:(e,n,t)=>{Promise.resolve().then(t.bind(t,9129))},9129:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>eA});var r=t(5155);let s=function(){for(var e,n,t=0,r="",s=arguments.length;t<s;t++)(e=arguments[t])&&(n=function e(n){var t,r,s="";if("string"==typeof n||"number"==typeof n)s+=n;else if("object"==typeof n)if(Array.isArray(n)){var i=n.length;for(t=0;t<i;t++)n[t]&&(r=e(n[t]))&&(s&&(s+=" "),s+=r)}else for(r in n)n[r]&&(s&&(s+=" "),s+=r);return s}(e))&&(r&&(r+=" "),r+=n);return r};function i(e){let{name:n,headerOptions:t,className:i,children:o}=e;return(0,r.jsxs)("section",{className:s("grid grid-rows-[24px_1fr]",i),children:[(0,r.jsx)(a,{name:n,options:t}),o]})}function a(e){let{name:n,options:t}=e;return(0,r.jsxs)("div",{className:"border-b-1 border-zinc-400 px-2 flex bg-black",children:[(0,r.jsx)("span",{className:"mr-auto font-bold",children:n}),t&&Object.keys(t).map(e=>(0,r.jsx)("input",{type:"button",className:"my-auto mx-2 cursor-pointer hover",value:e,onClick:t[e]},e))]})}function o(){return(0,r.jsx)("div",{className:"p3 overflow-y-scroll select-text",children:"Coming soon!"})}function c(){return(0,r.jsx)(i,{name:"Docs",className:"row-span-2 w-(--width1) border-r-1 border-zinc-400",children:(0,r.jsx)(o,{})})}function l(e){let{deep:n,arrow:t,name:s,childsElement:i,...a}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex",style:{marginLeft:8*n},children:[t,(0,r.jsx)("div",{className:"cursor-pointer hover",...a,children:s})]}),i]})}var u=t(2115);function d(){let e=(0,u.useState)(!1)[1];return()=>e(e=>!e)}class f{bind(e){if(e){let n=d();this.refresh=()=>{e(),n()}}else this.refresh=d()}get value(){return this.v}set value(e){var n;this.v=e,null==(n=this.refresh)||n.call(this)}constructor(e){this.refresh=()=>{throw Error("Refresh not bind!")},this.v=e}}function h(e){return new f(e)}function m(e,n){var t;let r=(t=new f(e),(0,u.useState)(t)[0]);return r.bind(n),r}function p(e){return JSON.parse(JSON.stringify(e))}function x(e){let{name:n,...t}=e,r=document.createElement(n);for(let e in t)r[e]=t[e];r.click()}function v(e,n){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];x({name:"a",href:"data:text;charset=utf-8,".concat(t?encodeURIComponent(n):n),download:e})}function y(e){return S.toUpperCase().includes(e[0])}function j(e){if(0===e.length||!y(e))return!1;for(let n of e)if(!A.includes(n.toLowerCase()))return!1;return!0}function b(e){return!y(e)&&!R.includes(e)}function w(){H.value=!0,L.value=T.pathToMainScene.split(".").slice(1).reduce((e,n)=>e[n],U.value)}function g(){let{position:e,rotation:n,scale:t,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(r).reduce((e,n)=>({[n]:r[n],...e}),{type:"gameObject",transform:{position:e||{x:0,y:0},rotation:n||{z:0},scale:t||{x:1,y:1}}})}function O(e){return 0===e.length||e[0]===e[0].toUpperCase()?e:"".concat(e[0].toUpperCase()).concat(e.slice(1))}function k(e,n){for(let n in e)delete e[n];for(let t in n)e[t]=n[t]}function N(){x({name:"input",type:"file",accept:".virginengine",onchange:e=>{let{target:n}=e,t=new FileReader;t.onload=e=>{let{target:n}=e,t=JSON.parse(n.result);k(T,t.conf),k(U.value,t.files),w()},t.readAsText(n.files[0])}})}function E(e){return"string"!=typeof e?typeof e:Array.isArray(e)||"["===e[0]?"array":"{"===e[0]?"object":0===e.indexOf("function")?"function":(['"',"'","`"].includes(e[0]),"string")}let S="abcdefghijklmnoprqstuwxyz",C="0123456789",A="".concat(S).concat(C,"_"),R=["type","transform","position","rotation","scale","text","rect","sprite"],T={gameName:"NameOfGame",version:"0.0.0",author:"YourNick",description:"Description",fullScreen:!1,pathToMainScene:"files.Scenes.DefaultScene"},z={type:"folder",Scenes:{type:"folder",MenuScene:{type:"scene",name:"MenuScene"},MainScene:{type:"scene",name:"MainScene"},DefaultScene:{name:"DefaultScene",type:"scene",Parent:g({start:"function() {\n  for(let i = 0; i < 1000; i++)\n    setTimeout(() => this.parent.Child.clone(scene))\n}"}),Child:g({scale:{x:20,y:20},sprite:{color:"#974",imagePath:""},start:"function() {\n  this.position = {x: Math.random() * window.innerWidth, y: Math.random() * window.innerHeight}\n}",update:"function() {\n  const x = this.position.x - 1\n  this.position = {x: x < 0 ? window.innerWidth : x, y: this.position.y}\n}"})}},Assets:{type:"folder",ExampleImage:{type:"image",value:{src:"data:image/png;base64",width:1,height:1}}}},L=h(z.Scenes.MainScene),M=h(null),P=h([]),_=h(null),D=h(""),U=h(z),G=h([]),H=h(!1);function F(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=m(e);return[n?(0,r.jsx)("div",{className:"w-6 h-6 text-center justify-self-center rounded-full cursor-pointer hover",style:{transform:"rotate(".concat(90*!!t.value,"deg)")},onClick:()=>t.value=!t.value,children:">"}):(0,r.jsx)("div",{className:"w-6 h-6"}),t]}function I(){let e=(0,u.useState)(!1)[1];return()=>e(e=>!e)}function B(e){let{sig:n}=e;return(0,r.jsx)("input",{type:"checkbox",className:s("w-5 h-5 my-auto accent-green-600 cursor-pointer",!n.value&&"opacity-20"),checked:n.value,onChange:e=>{let{target:t}=e;return n.value=t.checked}})}function K(e){let{sig:n}=e,t=m(String(n.value));return(0,r.jsx)("input",{type:"text",className:"w-full border-b-1 border-zinc-400 accent-green-600",value:t.value,onChange:e=>{let{target:{value:r}}=e,s=!1;for(let e of r){if(!"".concat(C,"-.").includes(e))return;if("."===e){if(s)return;s=!0}}let i=r.slice(1).includes("-")?-Number("".concat(r.at(0)).concat(r.slice(1).replaceAll("-",""))):Number(r);if(i||0===i){n.value=i,t.value=String(i);return}t.value=r}})}function J(e){let{sig:n}=e;return(0,r.jsx)("input",{type:"text",className:"w-full border-b-1 border-zinc-400 accent-green-600",value:n.value,onChange:e=>{let{target:t}=e;return n.value=t.value}})}function q(e){let{object:n,access:t,type:s}=e,i=m(n[t],()=>n[t]=i.value),a=s||E(i.value),o=function(e,n){switch(e){case"boolean":return(0,r.jsx)(B,{...n});case"number":return(0,r.jsx)(K,{...n});case"string":return(0,r.jsx)(J,{...n});case"array":case"object":case"function":case"enum":return null}}(a,{sig:i});return(0,r.jsxs)("div",{className:"w-full grid grid-cols-[auto_1fr] gap-3",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("span",{children:t.slice(1).split("").reduce((e,n)=>"".concat(e).concat(n===n.toUpperCase()?" ":"").concat(n),t[0].toUpperCase())}),(0,r.jsxs)("span",{className:"text-green-500",children:[": ",a]}),(0,r.jsx)("span",{children:"="})]}),o]})}function $(e){let{text:n,remove:t,childs:s,element:i}=e;return(0,r.jsxs)("div",{className:"mt-4 border-b-2 border-zinc-950 pb-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("h2",{className:"mb-2 border-l-4 border-zinc-800 pl-2 text-2xl font-bold",children:n}),t?(0,r.jsx)("input",{type:"button",value:"Remove",className:"mr-4 ml-auto cursor-pointer hover",onClick:t}):null]}),null==s?void 0:s.map(e=>(0,r.jsx)(q,{...e},e.access)),i]})}function W(e){var n;let{object:t,access:s}=e,i=(n=E(t[s]),(0,u.useState)(n)[0]);return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("div",{children:s}),(0,r.jsxs)("div",{className:"text-green-500",children:[": ",i]}),(0,r.jsx)("div",{children:"="})]}),(0,r.jsx)(Y,{object:t,access:s})]})}function Y(e){var n;let{object:t,access:s}=e,i=(0,u.useRef)(null),a=I();return(0,u.useEffect)(a,[i]),(0,r.jsx)("textarea",{ref:i,className:"w-full resize-none",style:{height:null==i||null==(n=i.current)?void 0:n.scrollHeight},value:t[s],onChange:e=>{let{target:n}=e;t[s]=n.value,a()}})}window.oncontextmenu=e=>e.preventDefault();let Q={boolean:[!1,q],number:[0,q],string:['""',q],array:['[12, 43, "foo"]',W,"[","]"],object:["{}",W,"{","}"],function:["function() {}",W,"function(",") {","}"]};function X(e){let{object:n,value:t,refresh:s}=e;return(0,r.jsx)(en,{text:O(t),onClick:()=>P.value=[e=>{!function(e,n){for(let t in e)if(t===n)return!0;return!1}(n,e)&&(n[e]=Q[t][0],s())},"",!0]})}function Z(e){let{object:n,refresh:t}=e;return(0,r.jsxs)(r.Fragment,{children:[Object.keys(n).filter(e=>b(e)).map(e=>(0,r.jsx)($,{text:e,element:Q[E(n[e])][1]({object:n,access:e}),remove:()=>{delete n[e],t()}},e)),(0,r.jsx)("div",{className:"mb-4 flex flex-wrap",children:Object.keys(Q).map(e=>(0,r.jsx)(X,{value:e,object:n,refresh:t},e))})]})}function V(e){let{object:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)($,{text:"Position",childs:[{object:n.transform.position,access:"x"},{object:n.transform.position,access:"y"}]}),(0,r.jsx)($,{text:"Rotation",childs:[{object:n.transform.rotation,access:"z"}]}),(0,r.jsx)($,{text:"Scale",childs:[{object:n.transform.scale,access:"x"},{object:n.transform.scale,access:"y"}]})]})}let ee={text:[[["value"]],{value:""},["rect"],[]],rect:[[["x"],["y"]],{x:0,y:0},[],["text"]],sprite:[[["color"],["imagePath"]],{color:"",imagePath:""},[],[]]};function en(e){let{text:n,onClick:t}=e;return(0,r.jsx)("input",{type:"button",value:"+ ".concat(n),className:"mt-3 mb-6 px-3 py-2 cursor-pointer hover",onClick:t})}function et(e){var n;let{name:t,refresh:s,readOnly:i,...a}=e;return a.object[t]?(0,r.jsx)($,{text:O(t),childs:(n=a.object,ee[t][0].reduce((e,r)=>[...e,{object:r.slice(0,-1).reduce((e,n)=>e[n],n[t]),access:r.at(-1)}],[])),...a,remove:i?void 0:()=>{for(let e of ee[t][3])delete a.object[e];delete a.object[t],s()}},t):(0,r.jsx)(en,{text:O(t),onClick:()=>{if(!i){for(let e of(a.object[t]=p(ee[t][1]),ee[t][2]))a.object[e]||(a.object[e]=p(ee[e][1]));s()}}})}function er(e){let{name:n,...t}=e,s=I();return t={...t,refresh:s},(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"ml-3 text-xl font-bold",children:n}),(0,r.jsx)(V,{object:t.object}),Object.keys(ee).map(e=>(0,u.createElement)(et,{...t,key:e,name:e})),(0,r.jsx)(Z,{object:t.object,refresh:s})]},JSON.stringify(t))}function es(e){var n;let{old:t,name:s,object:i,deep:a=0}=e,o=0===a,c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((n,t)=>!R.includes(t)&&y(t)?{[t]:e[t],...n}:n,{})}(i),[u,d]=F(o,(null==(n=Object.keys(c))?void 0:n.length)>0),f=d.value&&Object.entries(c).map(e=>{let[n,t]=e;return(0,r.jsx)(es,{old:i,object:t,name:n,deep:a+1},n)});return l({deep:a,name:s,arrow:u,childsElement:f,onClick:()=>{var e;return!o&&(e={old:t,object:i,name:s},void(M.value=(0,r.jsx)(er,{...e})))},onContextMenu:e=>{let{pageX:n,pageY:r}=e;G.value=[n,r,[()=>{P.value=[e=>{Object.keys(i).includes(e)||(i[e]=g(),d.value=!0,L.refresh())}]},"New Object"],[()=>{P.value=[e=>{s===e||t[e]||(delete t[s],t[e]=i,L.refresh())},s]},"Rename",!o],[()=>{delete t[s],L.refresh()},"Delete",!o]]},onMouseDown:()=>{o||(_.value={from:"hierarchy",old:t,file:i,name:s})},onMouseUp:()=>{let e=_.value;if(e&&e.name!==s&&"gameObject"===e.file.type){for(let n in c)if(n===e.name)return;i[e.name]=e.file,"hierarchy"===e.from&&e.old&&delete e.old[e.name],L.refresh()}}})}function ei(){return L.bind(()=>M.value=null),(0,r.jsx)(es,{object:L.value,old:U.value.Scenes,name:L.value.name,deep:0})}function ea(){return(0,r.jsx)(i,{name:"Hierarchy",className:"w-(--width2) h-(--height1) border-b-1 border-zinc-400",children:(0,r.jsx)("div",{className:"overflow-y-scroll",children:(0,r.jsx)(ei,{})})})}let eo='\n<!DOCTYPE html>\n<html lang="en">\n  <head>\n    <meta charset="UTF-8"/>\n    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>\n    <meta name="author" content="AUTHOR"/>\n    <meta name="description" content="DESCRIPTION"/>\n    <meta name="keywords" content="GAME_NAME,AUTHOR"/>\n\n    <title>GAME_NAME</title>\n\n    <style>\n      body {\n        background-color:black;\n        margin:0;\n        border:0;\n        user-select:none;\n        width:100vw;\n        height:100vh;\n        overflow:hidden;\n      }\n    </style>\n  </head>\n  <body>\n    <canvas></canvas>\n    <script>\n      SCRIPT\n    <\/script>\n  </body>\n</html>\n'.replaceAll("\n"," ").replaceAll(/\s{2,}/g," ").replaceAll("> ",">").replaceAll(" <","<").replaceAll("; ",";").replaceAll(" {","{").replaceAll("{ ","{").replaceAll(' "','"').replaceAll('" ','"');function ec(){return eo.replaceAll("AUTHOR",T.author).replaceAll("DESCRIPTION",T.description).replaceAll("GAME_NAME",T.gameName).replaceAll("SCRIPT",'var ctx = document.body.children[0].getContext(`2d`);\nvar files = `REPLACE_FILES`;\nvar events = {};\nvar eventsHover = {};\nvar gameObjects = [];\nvar Log = { updates: 0, frames: 0, framesTemp: 0 };\nvar GameTime = {\nms: 1,\nvalue: 1,\nlastTime: 0,\nget() {\nreturn this.value;\n},\nset(newTime) {\nthis.value = newTime;\nthis.ms = 1000 / (60 * this.value);\nthis.lastTime = performance.now();\n}\n};\nvar scene = {};\nfunction setScene(newScene) {\nscene = newScene;\n}\nclass Transform {\ngameObject;\npx = 0;\npy = 0;\nrz = 0;\nsx = 1;\nsy = 1;\nrect = { x: 0, y: 0 };\nconstructor(props, gameObject) {\nif (props && gameObject) {\nthis.gameObject = gameObject;\nconst { position, rotation, scale, rect } = props;\nif (position)\nthis.position = position;\nif (rotation)\nthis.rotation = rotation;\nif (scale)\nthis.scale = scale;\nif (rect)\nthis.rect = rect;\ngameObject.position = this.position;\ngameObject.rotation = this.rotation;\ngameObject.scale = this.scale;\n} else {\nthis.readonly = true;\n}\n}\nget position() {\nreturn { x: this.px, y: this.py };\n}\nset position({ x, y }) {\nif (this.readonly)\nthrow alert(`PROGRAMMER, you can\'t chage "readOnly" position`);\nfor (const child of this.gameObject.childs) {\nchild.transform.position = {\nx: child.transform.px - this.px + x,\ny: child.transform.py - this.py + y\n};\n}\nthis.px = x;\nthis.py = y;\n}\nget rotation() {\nreturn { z: this.rz };\n}\nset rotation({ z }) {\nif (this.readonly)\nthrow alert(`PROGRAMMER, you can\'t chage "readOnly" rotation`);\nwhile (z < 0) {\nz += 360;\n}\nwhile (z >= 360) {\nz -= 360;\n}\nfor (const child of this.gameObject.childs) {\nlet newRot = child.transform.rz - this.rz + z;\nif (newRot < 0) {\nnewRot += 360;\n} else if (newRot > 360) {\nnewRot -= 360;\n}\nchild.transform.rotation = { z: newRot };\n}\nthis.rz = z;\n}\nget scale() {\nreturn { x: this.sx, y: this.sy };\n}\nset scale({ x, y }) {\nif (this.readonly)\nthrow alert(`PROGRAMMER, you can\'t chage "readOnly" scale`);\nfor (const child of this.gameObject.childs) {\nchild.transform.scale = {\nx: child.transform.sx / this.sx * x,\ny: child.transform.sy / this.sy * y\n};\n}\nthis.sx = x;\nthis.sy = y;\n}\n}\nfunction Sprite(props, gameObject) {\nif (props.imagePath)\nreturn new PathSprite(props, gameObject);\nreturn new BoxSprite(props, gameObject);\n}\nclass BoxSprite {\ngameObject;\ncolor;\nconstructor({ color }, gameObject) {\nthis.gameObject = gameObject;\nthis.color = color;\ngameObject.toRender.push(this.render.bind(this));\n}\nrender() {\ndrawBoxMiddle(this.gameObject.position.x, this.gameObject.position.y, this.gameObject.scale.x, this.gameObject.scale.y, this.color);\n}\n}\nclass PathSprite {\ngameObject;\nimagePath;\nconstructor({ imagePath }, gameObject) {\nthis.gameObject = gameObject;\nthis.imagePath = imagePath;\ngameObject.toRender.push(this.render.bind(this));\nthrow Error(`PathSprite, camming soon!`);\n}\nrender() {}\n}\nvar textBaseline = [`top`, `middle`, `bottom`];\nvar textAlign = [`left`, `center`, `right`];\nclass Text {\nvalue;\nrect;\ntransform;\ntextBaseline;\ntextAlign;\nconstructor(value, gameObject, rect) {\nthis.transform = gameObject.transform;\nthis.value = value;\nthis.textBaseline = textBaseline[rect.x];\nthis.textAlign = textAlign[rect.y];\ngameObject.toRender.push(this.render.bind(this));\n}\nrender() {\ndraw({\ntext: this.value,\n...this.transform.position,\nfillStyle: `white`,\nfont: `${this.transform.scale.y}px serif`,\ntextBaseline: this.textBaseline,\ntextAlign: this.textAlign\n});\n}\n}\nvar keywords = [`toUpdate`, `toRender`, `parent`, `position`, `rotation`, `scale`];\nclass GameObject {\ntoUpdate = [];\ntoRender = [];\nparent;\nstart;\nupdate;\ntransform;\nposition;\nrotation;\nscale;\ntext;\nsprite;\nconstructor({ parent, transform, rect, text, sprite, start, update, render, ...rest }) {\nthis.parent = parent || new GameObject({ parent: {} });\nthis.transform = new Transform(transform, this);\nif (text)\nthis.text = new Text(text.value, this, rect);\nif (sprite)\nthis.sprite = Sprite(sprite, this);\nfor (const key in rest) {\nif (isChildKey(key)) {\nthis[key] = new GameObject({ ...rest[key], parent: this });\n} else {\nthis[key] = typeof rest[key] === `function` ? rest[key].bind(this) : rest[key];\n}\n}\nif (update) {\nthis.update = update;\nthis.toUpdate.push(() => this.update.bind(this)());\n}\nif (render)\nthis.toRender.push(() => render.bind(this)());\nif (start) {\nthis.start = start;\nthis.start.bind(this)();\n}\ngameObjects.push(this);\n}\nget childs() {\nconst childs = [];\nfor (const key in this) {\nif (isChildKey(key))\nchilds.push(this[key]);\n}\nreturn childs;\n}\nget name() {\nfor (const key in this.parent) {\nif (this === this.parent[key])\nreturn key;\n}\nthrow Error(`No name in Obj!`);\n}\nget props() {\nconst newObj = {\nstart: this?.start,\nupdate: this?.update,\ntransform: {\nposition: this.position,\nrotation: this.rotation,\nscale: this.scale,\nrect: this.transform.rect\n}\n};\nfor (const key in this) {\nif (!(key in newObj) && !keywords.includes(key))\nnewObj[key] = this[key];\n}\nreturn deepCopy(newObj);\n}\nclone(parent) {\nconst name = this.name;\nlet newName = name;\nlet i = 0;\nwhile (parent[newName]) {\nnewName = `${name}${i}`;\ni++;\n}\nparent[newName] = new GameObject({ ...this.props, parent });\n}\ndestroy() {\nfor (const child of this.childs)\nchild.destroy();\nconst { parent } = this;\nconst parentKey = this.name;\nfor (const key in this)\ndelete this[key];\ngameObjects.splice(gameObjects.indexOf(this));\ndelete parent[parentKey];\n}\n}\nasync function wait(time) {\nawait new Promise((r) => setTimeout(r, time));\n}\nfunction isChildKey(text) {\nreturn `ABCDEFGHIJKLMNOPRQSTUWXYZ`.includes(text.at(0));\n}\nfunction deepCopy(data) {\nif (Array.isArray(data)) {\nreturn data.reduce((prev, val) => [...prev, deepCopy(val)], []);\n}\nif (typeof data === `object`) {\nconst newObj = {};\nfor (const key in data) {\nif ([`parent`, `toUpdate`, `toRender`, `gameObject`].includes(key))\ncontinue;\nnewObj[key] = deepCopy(data[key]);\n}\nreturn newObj;\n}\nreturn data;\n}\nfunction loadScene({ name, ...newScene }) {\ngameObjects.length = 0;\nfor (const key in events)\ndelete events[key];\nfor (const key in eventsHover)\ndelete eventsHover[key];\nsetScene(new GameObject(deepCopy(newScene)));\nscene.name = name;\nonresize();\n}\nfunction draw({ text, color, x, y, w, h, ...props }) {\nctx.save();\nfor (const key in props) {\nctx[key] = props[key];\n}\nif (text)\nctx.fillText(text, x, y);\nif (color) {\nctx.fillStyle = color;\nctx.fillRect(x, y, w, h);\n}\nctx.restore();\n}\nfunction drawBoxMiddle(x, y, w, h, color) {\ndraw({ x: x - w / 2, y: y - h / 2, w, h, color });\n}\nfunction onresize() {\nctx.canvas.width = window.innerWidth;\nctx.canvas.height = window.innerHeight;\n}\nasync function run() {\nGameTime.set(1);\nrequestAnimationFrame(render);\nlet timer = performance.now();\nlet updates = 0;\nlet delta = 0;\nwhile (true) {\nconst now = performance.now();\ndelta += (now - GameTime.lastTime) / GameTime.ms;\nif (delta > 60)\ndelta = 60;\nGameTime.lastTime = now;\nwhile (delta >= 1) {\nupdate();\nupdates++;\ndelta--;\n}\nif (now - timer > 1000) {\ntimer += 1000;\nLog.updates = updates;\nLog.frames = Log.framesTemp;\nupdates = 0;\nLog.framesTemp = 0;\n}\nawait wait();\n}\n}\nfunction update() {\nfor (const obj of gameObjects) {\nfor (const f of obj.toUpdate)\nf();\n}\nfor (const key in events)\ndelete events[key];\n}\nfunction render() {\nctx.fillStyle = `black`;\nctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\nfor (const obj of gameObjects) {\nfor (const f of obj.toRender)\nf();\n}\nconst props = {\nx: 8,\ny: 8,\nfillStyle: `white`,\nfont: `22px serif`,\ntextAlign: `left`,\ntextBaseline: `top`\n};\ndraw({ text: `Update ${Log.updates}`, ...props });\ndraw({ text: `Render ${Log.frames}`, ...props, y: 38 });\nLog.framesTemp++;\nrequestAnimationFrame(render);\n}\nwindow.addEventListener(`mousedown`, () => eventsHover.click = true);\nwindow.addEventListener(`mouseup`, () => delete eventsHover.click);\nwindow.addEventListener(`click`, () => events.click = true);\nwindow.addEventListener(`keydown`, ({ key }) => events[key] = eventsHover[key] = true);\nwindow.addEventListener(`keyup`, ({ key }) => delete eventsHover[key]);\nwindow.addEventListener(`contextmenu`, (e) => {\ne.preventDefault();\n!document.fullscreenElement ? document.documentElement.requestFullscreen() : document.exitFullscreen();\n});\nwindow.addEventListener(`resize`, onresize);\nconsole.log(`Engine:`, !!files);\nonresize();\nloadScene(`REPLACE_PATH_TO_MAIN_SCENE`);\nrun();'.replace("`REPLACE_FILES`",function e(n,t,r){return Array.isArray(n)?"".concat(n.reduce((n,t)=>"".concat(n).concat(e(t),","),"[").slice(0,-1),"]"):"object"==typeof n?"".concat(Object.keys(n).reduce((t,r)=>"".concat(t).concat(r,":").concat(e(n[r],r,n.type),","),"{").slice(0,-1),"}"):"gameObject"===r&&b(t)?n:JSON.stringify(n)}(U.value)).replace("`REPLACE_PATH_TO_MAIN_SCENE`",T.pathToMainScene))}function el(){D.value=ec()}function eu(){v("".concat(T.gameName,".virginengine"),JSON.stringify({conf:T,files:U.value}))}function ed(){return(0,r.jsx)($,{text:"Config",childs:Object.keys(T).filter(e=>"type"!==e).map(e=>({text:e,object:T,access:e}))})}window.addEventListener("keydown",e=>{e.ctrlKey&&"s"===e.key&&(e.preventDefault(),eu())});let ef={Test:el,Save:eu,Build:function(){v("".concat(T.gameName,".html"),ec(),!0)},Load:N,Config:()=>M.value=(0,r.jsx)(ed,{})};function eh(){return M.bind(),M.value}function em(){return(0,r.jsx)(i,{name:"Inspenctor",className:"row-span-2 w-(--width3) border-l-1 border-zinc-400",headerOptions:ef,children:(0,r.jsx)("div",{className:"p-2 overflow-y-scroll",children:(0,r.jsx)(eh,{})})})}function ep(e){let{old:n,file:t,name:s,deep:i=0,path:a="files"}=e,o=0===i;o||(a+=".".concat(s));let c="folder"===t.type,[u,d]=F(o,c),f=d.value&&"scene"!==t.type&&Object.entries(t).map(e=>{let[n,s]=e;return y(n)&&(0,r.jsx)(ep,{old:t,file:s,name:n,deep:i+1,path:a},n)});return l({deep:i,name:s,arrow:u,childsElement:f,onClick:()=>{M.value=(0,r.jsxs)("div",{className:"m-3",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"File"}),(0,r.jsxs)("div",{children:["Type: ",t.type]}),(0,r.jsxs)("div",{children:["Name: ",s]})]})},onContextMenu:e=>{let{pageX:r,pageY:i}=e,l=(e,n)=>[()=>P.value=[e=>{t[e]={type:n},d.value=!0,U.refresh()}],e,c];G.value=[r,i,l("New file","txt"),l("New folder","folder"),l("New scene","scene"),[()=>P.value=[e=>{s!==e&&(delete n[s],n[e]=t,U.refresh())},s],"Rename",!o],[()=>navigator.clipboard.writeText(a),"Copy path"],[()=>{delete n[s],U.refresh()},"Delete",!o]]},onMouseDown:()=>{o||(_.value={from:"files",old:n,file:t,name:s})},onMouseUp:()=>{if(!c)return;let e=_.value;(null==e?void 0:e.from)!=="files"||e.name===s||t[e.name]||(t[e.name]=e.file,e.old&&delete e.old[e.name],U.refresh())},onDoubleClick:()=>"scene"===t.type&&void(L.value=t)})}let ex=()=>(U.bind(),(0,r.jsx)(ep,{file:U.value,name:"files",deep:0,old:!0}));function ev(){return(0,r.jsx)(i,{name:"Files",className:"w-(--width2) h-(--height2)",children:(0,r.jsx)("div",{className:"overflow-y-scroll",children:(0,r.jsx)(ex,{})})})}function ey(e){return(0,r.jsx)("input",{className:"mx-auto my-6 border-4 border-zinc-400 px-16 py-4 text-5xl cursor-pointer hover",type:"button",...e})}function ej(){return H.bind(),H.value?null:(0,r.jsxs)("div",{className:"absolute z-1 w-screen h-screen flex flex-col justify-center bg-[#000a]",children:[(0,r.jsx)(ey,{value:"Load Project",onClick:()=>N()}),(0,r.jsx)(ey,{value:"New project",onClick:w})]})}function eb(){let e=(0,u.useRef)(null);return G.bind(),(0,u.useEffect)(()=>{function n(n){let{target:t}=n;e.current&&!e.current.contains(t)&&(G.value=[])}return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[e]),G.value.length>2?(0,r.jsx)("div",{ref:e,className:"absolute z-1 border-4 border-zinc-800 px-2 py-0.5 bg-black",style:{inset:"".concat(G.value[1],"px auto auto ").concat(G.value[0],"px")},children:G.value.slice(2).map(e=>{let[n,t,s=!0]=e;return s?(0,r.jsx)("div",{className:"cursor-pointer hover",onClick:()=>{n(),G.value=[]},children:t},t):null})}):null}function ew(){let e=(0,u.useRef)(null),n=function(e){P.bind();let[n,t="",r=!1]=P.value,s=()=>{n&&j(t)&&n(r?"".concat(t[0].toLowerCase()).concat(t.slice(1)):t),P.value=[]};return(0,u.useEffect)(()=>{if(e)return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n);function n(n){let{target:t}=n;e.current&&!e.current.contains(t)&&s()}}),n?{value:t,onChange:e=>{let{target:t}=e,s=O(t.value);j(s)&&(P.value=[n,s,r])},onKeyDown:e=>{let{key:n}=e;return"Enter"===n&&s()}}:null}(e);return n&&(0,r.jsx)("input",{ref:e,type:"text",className:"absolute z-1 text-4xl translate-x-[calc(50vw-50%)] translate-y-[calc(50vh-50%)]",...n,autoFocus:!0})}let eg=h(void 0);function eO(e){let{clientX:n,clientY:t,buttons:r}=e;1===r&&(console.log("Render"),eg.value={left:n+3,top:t+3})}function ek(){_.value=null,eg.value=void 0}function eN(){var e;return _.bind(),eg.bind(),(0,u.useEffect)(()=>{if(_.value)return window.addEventListener("mousemove",eO),window.addEventListener("mouseup",ek),()=>{window.removeEventListener("mousemove",eO),window.removeEventListener("mouseup",ek)}}),eg.value?(0,r.jsx)("div",{className:"absolute z-1 bg-[#000a]",style:eg.value,children:null==(e=_.value)?void 0:e.name}):null}let eE={"16/9":"aspect-[16/9]","1/1":"aspect-square","9/16":"aspect-[9/16]"},eS=h(eE["16/9"]);function eC(){if(D.bind(console.clear),eS.bind(),D.value)return(0,r.jsx)(i,{name:"Test",className:"absolute z-1 w-screen h-screen",headerOptions:{...Object.entries(eE).reduce((e,n)=>{let[t,r]=n;return{...e,[t]:()=>eS.value=r}},{}),Restart:()=>{D.value=".",setTimeout(el)},Exit:()=>D.value=""},children:(0,r.jsx)("div",{className:"flex justify-center bg-zinc-950",children:(0,r.jsx)("iframe",{title:"scene",className:s("box-content border-x-1 border-zinc-400",eS.value),srcDoc:D.value})})})}function eA(){if(function(){let[e,n]=(0,u.useState)(!1);return(0,u.useEffect)(()=>n(!0),[e]),e}())return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{children:[(0,r.jsx)(ej,{}),(0,r.jsx)(eb,{}),(0,r.jsx)(ew,{}),(0,r.jsx)(eN,{}),(0,r.jsx)(eC,{})]}),(0,r.jsxs)("main",{className:"w-screen h-screen grid grid-cols-[30fr_30fr_40fr] grid-rows-[55fr_45fr]",children:[(0,r.jsx)(c,{}),(0,r.jsx)(ea,{}),(0,r.jsx)(em,{}),(0,r.jsx)(ev,{})]})]})}}},e=>{var n=n=>e(e.s=n);e.O(0,[441,684,358],()=>n(6928)),_N_E=e.O()}]);