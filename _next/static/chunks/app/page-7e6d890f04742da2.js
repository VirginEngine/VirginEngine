(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3914:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>eA});var r=t(5155);let s=function(){for(var e,n,t=0,r="",s=arguments.length;t<s;t++)(e=arguments[t])&&(n=function e(n){var t,r,s="";if("string"==typeof n||"number"==typeof n)s+=n;else if("object"==typeof n)if(Array.isArray(n)){var o=n.length;for(t=0;t<o;t++)n[t]&&(r=e(n[t]))&&(s&&(s+=" "),s+=r)}else for(r in n)n[r]&&(s&&(s+=" "),s+=r);return s}(e))&&(r&&(r+=" "),r+=n);return r};function o(e){let{name:n,options:t}=e;return(0,r.jsxs)("div",{className:"border-b-1 border-solid border-zinc-400 px-2 flex bg-black",children:[(0,r.jsx)("span",{className:"mr-auto font-bold",children:n}),t&&Object.keys(t).map(e=>(0,r.jsx)("input",{type:"button",className:"my-auto mx-2 cursor-pointer hover",value:e,onClick:t[e]},e))]})}function i(e){let{name:n,headerOptions:t,className:i,children:a}=e;return(0,r.jsxs)("section",{className:s("grid grid-rows-[24px_1fr]",i),children:[(0,r.jsx)(o,{name:n,options:t}),a]})}function a(){return(0,r.jsx)("div",{className:"p3 overflow-y-scroll select-text",children:"Coming soon!"})}function l(){return(0,r.jsx)(i,{name:"Docs",className:"row-span-2 w-(--width1) border-r-1 border-solid border-zinc-400",children:(0,r.jsx)(a,{})})}function c(e){let{deep:n,arrow:t,name:s,childsElement:o,...i}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex",style:{marginLeft:8*n},children:[t,(0,r.jsx)("div",{className:"cursor-pointer hover",...i,children:s})]}),o]})}var u=t(2115);function d(){let e=(0,u.useState)(!1)[1];return()=>e(e=>!e)}class f{bind(e){if(e){let n=d();this.refresh=()=>{e(),n()}}else this.refresh=d()}get value(){return this.v}set value(e){var n;this.v=e,null==(n=this.refresh)||n.call(this)}constructor(e){this.refresh=()=>{throw Error("Refresh not bind!")},this.v=e}}function m(e){return new f(e)}function h(e,n){var t;let r=(t=new f(e),(0,u.useState)(t)[0]);return r.bind(n),r}function p(e){return JSON.parse(JSON.stringify(e))}function v(e){let{name:n,...t}=e,r=document.createElement(n);for(let e in t)r[e]=t[e];r.click()}function x(e,n){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];v({name:"a",href:"data:text;charset=utf-8,".concat(t?encodeURIComponent(n):n),download:e})}function b(e){return C.toUpperCase().includes(e[0])}function j(e){if(0===e.length||!b(e))return!1;for(let n of e)if(!A.includes(n.toLowerCase()))return!1;return!0}function y(e){return!b(e)&&!T.includes(e)}function g(){U.value=!0;let e=D.value;for(let n of R.pathToMainScene.split(".").slice(1))e=e[n];z.value=e}function w(){let{position:e,rotation:n,scale:t,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(r).reduce((e,n)=>({[n]:r[n],...e}),{type:"gameObject",transform:{position:e||{x:0,y:0},rotation:n||{z:0},scale:t||{x:1,y:1}}})}function k(e){return 0===e.length||e[0]===e[0].toUpperCase()?e:"".concat(e[0].toUpperCase()).concat(e.slice(1))}function O(e,n){for(let n in e)delete e[n];for(let t in n)e[t]=n[t]}function N(){v({name:"input",type:"file",accept:".virginengine",onchange:e=>{let{target:n}=e,t=new FileReader;t.onload=e=>{let{target:n}=e,t=JSON.parse(n.result);O(R,t.conf),O(D.value,t.files),g()},t.readAsText(n.files[0])}})}function E(e){return"string"!=typeof e?typeof e:Array.isArray(e)||"["===e[0]?"array":"{"===e[0]?"object":0===e.indexOf("function")?"function":(['"',"'","`"].includes(e[0]),"string")}let C="abcdefghijklmnoprqstuwxyz",S="0123456789",A="".concat(C).concat(S,"_"),T=["type","transform","position","rotation","scale","text","rect","sprite"],R={gameName:"NameOfGame",version:"0.0.0",author:"YourNick",description:"Description",fullScreen:!1,pathToMainScene:"files.Scenes.DefaultScene"},L={type:"folder",Scenes:{type:"folder",MenuScene:{type:"scene",name:"MenuScene"},MainScene:{type:"scene",name:"MainScene"},DefaultScene:{name:"DefaultScene",type:"scene",Parent:w({start:"function() {\n  for(let i = 0; i < 10; i++)\n    setTimeout(() => clone(this.parent.Child, scene))\n}"}),Child:w({scale:{x:20,y:20},sprite:{color:"red",imagePath:""},start:'function() {\n  this.position = {x: Math.random() * 1000, y: Math.random() * window.innerHeight}\n  console.log("Start ".concat(this.position.x))\n}',update:"function() { console.log(this.position.x, this.name) }"})}},Assets:{type:"folder",ExampleImage:{type:"image",value:{src:"data:image/png;base64",width:1,height:1}}}},z=m(L.Scenes.MainScene),M=m(null),_=m([]),G=m(null),P=m(""),D=m(L),H=m([]),U=m(!1);function F(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=h(e);return[n?(0,r.jsx)("div",{className:"w-6 h-6 text-center justify-self-center rounded-full cursor-pointer hover",style:{transform:"rotate(".concat(90*!!t.value,"deg)")},onClick:()=>t.value=!t.value,children:">"}):(0,r.jsx)("div",{className:"w-6 h-6"}),t]}function I(){let e=(0,u.useState)(!1)[1];return()=>e(e=>!e)}function Y(e){let{sig:n}=e;return(0,r.jsx)("input",{type:"checkbox",className:s("w-5 h-5 my-auto accent-green-600 cursor-pointer",!n.value&&"opacity-20"),checked:n.value,onChange:e=>{let{target:t}=e;return n.value=t.checked}})}function X(e){let{sig:n}=e,t=h(String(n.value));return(0,r.jsx)("input",{type:"text",className:"w-full border-b-1 border-solid border-zinc-400 accent-green-600",value:t.value,onChange:e=>{let{target:{value:r}}=e,s=!1;for(let e of r){if(!"".concat(S,"-.").includes(e))return;if("."===e){if(s)return;s=!0}}let o=r.slice(1).includes("-")?-Number("".concat(r.at(0)).concat(r.slice(1).replaceAll("-",""))):Number(r);if(o||0===o){n.value=o,t.value=String(o);return}t.value=r}})}function B(e){let{sig:n}=e;return(0,r.jsx)("input",{type:"text",className:"w-full border-b-1 border-solid border-zinc-400 accent-green-600",value:n.value,onChange:e=>{let{target:t}=e;return n.value=t.value}})}function K(e){let{object:n,access:t,type:s}=e,o=h(n[t],()=>n[t]=o.value),i=s||E(o.value),a=function(e,n){switch(e){case"boolean":return(0,r.jsx)(Y,{...n});case"number":return(0,r.jsx)(X,{...n});case"string":return(0,r.jsx)(B,{...n});case"array":case"object":case"function":case"enum":return null;default:throw Error("No such type!")}}(i,{sig:o});return(0,r.jsxs)("div",{className:"w-full grid grid-cols-[auto_1fr] gap-3",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("span",{children:t.slice(1).split("").reduce((e,n)=>"".concat(e).concat(n===n.toUpperCase()?" ":"").concat(n),t[0].toUpperCase())}),(0,r.jsxs)("span",{className:"text-green-500",children:[": ",i]}),(0,r.jsx)("span",{children:"="})]}),a]})}function J(e){let{text:n,remove:t,childs:s,element:o}=e;return(0,r.jsxs)("div",{className:"mt-4 border-b-2 border-solid border-zinc-950 pb-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("h2",{className:"mb-2 border-l-4 border-solid border-zinc-800 pl-2 text-2xl font-bold",children:n}),t?(0,r.jsx)("input",{type:"button",value:"Remove",className:"mr-4 ml-auto cursor-pointer hover",onClick:t}):null]}),null==s?void 0:s.map(e=>(0,r.jsx)(K,{...e},e.access)),o]})}function Z(e){var n;let{object:t,access:s}=e,o=(n=E(t[s]),(0,u.useState)(n)[0]);return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("div",{children:s}),(0,r.jsxs)("div",{className:"text-green-500",children:[": ",o]}),(0,r.jsx)("div",{children:"="})]}),(0,r.jsx)($,{object:t,access:s})]})}function $(e){var n;let{object:t,access:s}=e,o=(0,u.useRef)(null),i=I();return(0,u.useEffect)(i,[o]),(0,r.jsx)("textarea",{ref:o,className:"w-full resize-none",style:{height:null==o||null==(n=o.current)?void 0:n.scrollHeight},value:t[s],onChange:e=>{let{target:n}=e;t[s]=n.value,i()}})}window.oncontextmenu=e=>e.preventDefault();let q={boolean:[!1,K],number:[0,K],string:['""',K],array:['[12, 43, "foo"]',Z,"[","]"],object:["{}",Z,"{","}"],function:["function() {}",Z,"function(",") {","}"]};function W(e){let{object:n,value:t,refresh:s}=e;return(0,r.jsx)(en,{text:k(t),onClick:()=>_.value=[e=>{!function(e,n){for(let t in e)if(t===n)return!0;return!1}(n,e)&&(n[e]=q[t][0],s())},"",!0]})}function Q(e){let{object:n,refresh:t}=e;return(0,r.jsxs)(r.Fragment,{children:[Object.keys(n).filter(e=>y(e)).map(e=>(0,r.jsx)(J,{text:e,element:q[E(n[e])][1]({object:n,access:e}),remove:()=>{delete n[e],t()}},e)),(0,r.jsx)("div",{className:"mb-4 flex flex-wrap",children:Object.keys(q).map(e=>(0,r.jsx)(W,{value:e,object:n,refresh:t},e))})]})}function V(e){let{object:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(J,{text:"Position",childs:[{object:n.transform.position,access:"x"},{object:n.transform.position,access:"y"}]}),(0,r.jsx)(J,{text:"Rotation",childs:[{object:n.transform.rotation,access:"z"}]}),(0,r.jsx)(J,{text:"Scale",childs:[{object:n.transform.scale,access:"x"},{object:n.transform.scale,access:"y"}]})]})}let ee={text:[[["value"]],{value:""},["rect"],[]],rect:[[["x"],["y"]],{x:0,y:0},[],["text"]],sprite:[[["color"],["imagePath"]],{color:"",imagePath:""},[],[]]};function en(e){let{text:n,onClick:t}=e;return(0,r.jsx)("input",{type:"button",value:"+ ".concat(n),className:"mt-3 mb-6 px-3 py-2 cursor-pointer hover",onClick:t})}function et(e){var n;let{name:t,refresh:s,readOnly:o,...i}=e;return i.object[t]?(0,r.jsx)(J,{text:k(t),childs:(n=i.object,ee[t][0].reduce((e,r)=>[...e,{object:r.slice(0,-1).reduce((e,n)=>e[n],n[t]),access:r.at(-1)}],[])),...i,remove:o?void 0:()=>{for(let e of ee[t][3])delete i.object[e];delete i.object[t],s()}},t):(0,r.jsx)(en,{text:k(t),onClick:()=>{if(!o){for(let e of(i.object[t]=p(ee[t][1]),ee[t][2]))i.object[e]||(i.object[e]=p(ee[e][1]));s()}}})}function er(e){let{name:n,...t}=e,s=I();return t={...t,refresh:s},(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"ml-3 text-xl font-bold",children:n}),(0,r.jsx)(V,{object:t.object}),Object.keys(ee).map(e=>(0,u.createElement)(et,{...t,key:e,name:e})),(0,r.jsx)(Q,{object:t.object,refresh:s})]},JSON.stringify(t))}function es(e){var n;let{old:t,name:s,object:o,deep:i=0}=e,a=0===i,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((n,t)=>!T.includes(t)&&b(t)?{[t]:e[t],...n}:n,{})}(o),[u,d]=F(a,(null==(n=Object.keys(l))?void 0:n.length)>0),f=d.value&&Object.entries(l).map(e=>{let[n,t]=e;return(0,r.jsx)(es,{old:o,object:t,name:n,deep:i+1},n)});return c({deep:i,name:s,arrow:u,childsElement:f,onClick:()=>{var e;return!a&&(e={old:t,object:o,name:s},void(M.value=(0,r.jsx)(er,{...e})))},onContextMenu:e=>{let{pageX:n,pageY:r}=e;H.value=[n,r,[()=>{_.value=[e=>{Object.keys(o).includes(e)||(o[e]=w(),d.value=!0,z.refresh())}]},"New Object"],[()=>{_.value=[e=>{s===e||t[e]||(delete t[s],t[e]=o,z.refresh())},s]},"Rename",!a],[()=>{delete t[s],z.refresh()},"Delete",!a]]},onMouseDown:()=>{a||(G.value={from:"hierarchy",old:t,file:o,name:s})},onMouseUp:()=>{let e=G.value;if(e&&e.name!==s&&"gameObject"===e.file.type){for(let n in l)if(n===e.name)return;o[e.name]=e.file,"hierarchy"===e.from&&e.old&&delete e.old[e.name],z.refresh()}}})}function eo(){return z.bind(()=>M.value=null),(0,r.jsx)(es,{object:z.value,old:D.value.Scenes,name:z.value.name,deep:0})}function ei(){return(0,r.jsx)(i,{name:"Hierarchy",className:"w-(--width2) h-(--height1) border-b-1 border-solid border-zinc-400",children:(0,r.jsx)("div",{className:"overflow-y-scroll",children:(0,r.jsx)(eo,{})})})}let ea='\n<!DOCTYPE html>\n<html lang="en">\n  <head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width,initial-scale=1.0">\n    <meta name="author" content="AUTHOR">\n    <meta name="description" content="DESCRIPTION">\n    <meta name="keywords" content="GAME_NAME,AUTHOR">\n\n    <title>GAME_NAME</title>\n\n  </head>\n  <body style="\n    background-color:black;\n    margin:0;\n    border:0;\n    padding:0;\n    user-select:none;\n    width:100vw;\n    height:100vh;\n    overflow:hidden;">\n\n    <canvas></canvas>\n    <script>\n      SCRIPT\n    <\/script>\n  </body>\n</html>\n'.replaceAll("\n"," ").replaceAll(/\s{2,}/g," ").replaceAll("> ",">").replaceAll(" <","<").replaceAll("; ",";").replaceAll(" {","{").replaceAll("{ ","{").replaceAll(' "','"').replaceAll('" ','"');function el(){return ea.replaceAll("AUTHOR",R.author).replaceAll("DESCRIPTION",R.description).replaceAll("GAME_NAME",R.gameName).replaceAll("SCRIPT",'var ctx = document.body.children[0].getContext(`2d`);\nfunction onresize() {\nctx.canvas.width = window.innerWidth;\nctx.canvas.height = window.innerHeight;\n}\nwindow.addEventListener(`resize`, onresize);\nonresize();\nvar files = `REPLACE_FILES`;\nconsole.log(files);\nvar scene = {};\nfunction setScene(newScene, name) {\nscene = newScene;\nscene.name = name;\n}\nvar events = {};\nvar eventsHover = {};\nwindow.addEventListener(`mousedown`, () => eventsHover.click = true);\nwindow.addEventListener(`mouseup`, () => delete eventsHover.click);\nwindow.addEventListener(`click`, () => events.click = true);\nwindow.addEventListener(`keydown`, ({ key }) => events[key] = eventsHover[key] = true);\nwindow.addEventListener(`keyup`, ({ key }) => delete eventsHover[key]);\nwindow.addEventListener(`contextmenu`, (e) => {\ne.preventDefault();\n!document.fullscreenElement ? document.documentElement.requestFullscreen() : document.exitFullscreen();\n});\nvar GameTime = {\nms: 1,\nvalue: 1,\nlastTime: 0,\nget() {\nreturn GameTime.value;\n},\nset(newTime) {\nGameTime.value = newTime;\nGameTime.ms = 1000 / (60 * GameTime.value);\nGameTime.lastTime = performance.now();\n}\n};\nvar Log = { updates: 0, frames: 0, framesTemp: 0 };\nvar gameObjects = [];\nclass Sprite {\ngameObject;\ncolor;\nconstructor({ color }, gameObject) {\nthis.gameObject = gameObject;\nthis.color = color;\ngameObject.toRender.push(this.render.bind(this));\n}\nrender() {\ndraw({\nx: this.gameObject.position.x,\ny: this.gameObject.position.y,\nw: this.gameObject.scale.x,\nh: this.gameObject.scale.y,\ncolor: this.color\n});\n}\n}\nclass Text {\nvalue;\nrect;\ntransform;\ntextBaseline;\ntextAlign;\nconstructor(value, gameObject, rect) {\nthis.transform = gameObject.transform;\nthis.value = value;\nthis.textBaseline = Text.textBaseline[rect.x];\nthis.textAlign = Text.textAlign[rect.y];\ngameObject.toRender.push(this.render.bind(this));\n}\nrender() {\ndraw({\ntext: this.value,\n...this.transform.position,\nfillStyle: `white`,\nfont: `${this.transform.scale.y}px serif`,\ntextBaseline: this.textBaseline,\ntextAlign: this.textAlign\n});\n}\nstatic textBaseline = [`top`, `middle`, `bottom`];\nstatic textAlign = [`left`, `center`, `right`];\n}\nclass Transform {\ngameObject;\npositionX = 0;\npositionY = 0;\nrotationZ = 0;\nscaleX = 1;\nscaleY = 1;\nrect;\nconstructor(props, gameObject) {\nif (props && gameObject) {\nthis.gameObject = gameObject;\nconst { position, rotation, scale, rect } = props;\nthis.position = position;\nthis.rotation = rotation;\nthis.scale = scale;\nthis.rect = rect;\ngameObject.position = position;\ngameObject.rotation = rotation;\ngameObject.scale = scale;\n} else {\nthis.readonly = true;\n}\n}\nget position() {\nreturn { x: this.positionX, y: this.positionY };\n}\nset position({ x, y }) {\nif (this.readonly) {\nalert(`PROGRAMMER, you can\'t chage "readOnly" position`);\nreturn;\n}\nfor (const child of this.gameObject.childs) {\nchild.transform.position = {\nx: child.transform.positionX - this.positionX + x,\ny: child.transform.positionY - this.positionY + y\n};\n}\nthis.positionX = x;\nthis.positionY = y;\n}\nget rotation() {\nreturn { z: this.rotationZ };\n}\nset rotation({ z }) {\nif (this.readonly) {\nthrow alert(`PROGRAMMER, you can\'t chage "readOnly" rotation`);\n}\nwhile (z < 0) {\nz += 360;\n}\nwhile (z > 360) {\nz -= 360;\n}\nfor (const child of this.gameObject.childs) {\nlet newRot = child.transform.rotationZ - this.rotationZ + z;\nif (newRot < 0) {\nnewRot += 360;\n} else if (newRot > 360) {\nnewRot -= 360;\n}\nchild.transform.rotation = { z: newRot };\n}\nthis.rotationZ = z;\n}\nget scale() {\nreturn { x: this.scaleX, y: this.scaleY };\n}\nset scale({ x, y }) {\nif (this.readonly) {\nalert(`PROGRAMMER, you can\'t chage "readOnly" scale`);\nreturn;\n}\nfor (const child of this.gameObject.childs) {\nchild.transform.scale = {\nx: child.transform.scaleX / this.scaleX * x,\ny: child.transform.scaleY / this.scaleY * y\n};\n}\nthis.scaleX = x;\nthis.scaleY = y;\n}\n}\nclass GameObject {\ntoUpdate = [];\ntoRender = [];\nparent;\nstart;\nupdate;\ntransform;\nposition;\nrotation;\nscale;\ntext;\nsprite;\nconstructor({ parent, transform, rect, text, sprite, start, update, render, ...rest }) {\nif (parent)\nthis.parent = parent;\nthis.transform = new Transform(transform, this);\nif (text)\nthis.text = new Text(text.value, this, rect);\nif (sprite)\nthis.sprite = new Sprite(sprite, this);\nfor (const key in rest) {\nif (isChildKey(key)) {\nthis[key] = new GameObject({ ...rest[key], parent: this });\n} else {\nthis[key] = typeof rest[key] === `function` ? rest[key].bind(this) : rest[key];\n}\n}\nif (update)\nthis.toUpdate.push(update.bind(this));\nif (render)\nthis.toRender.push(render.bind(this));\nif (start) {\nthis.start = start.bind(this);\nthis.start();\n}\ngameObjects.push(this);\n}\nget childs() {\nconst childs = [];\nfor (const key in this) {\nif (isChildKey(key))\nchilds.push(this[key]);\n}\nreturn childs;\n}\nget name() {\nfor (const key in this.parent) {\nif (this === this.parent[key])\nreturn key;\n}\n}\nget props() {\nconst newObj = {\nstart: this?.start,\nupdate: this?.update,\ntransform: {\nposition: this.position,\nrotation: this.rotation,\nscale: this.scale\n}\n};\nreturn deepCopy(newObj);\n}\nstatic destroy(obj) {\nfor (const child of obj.childs)\nGameObject.destroy(child);\nconst { parent } = obj;\nlet parentKey = ``;\nfor (const key in obj.parent) {\nif (obj.parent[key] === obj) {\nparentKey = key;\nbreak;\n}\n}\nfor (const key in obj)\ndelete obj[key];\ngameObjects.splice(gameObjects.indexOf(obj));\ndelete parent[parentKey];\n}\n}\nasync function wait0() {\nawait new Promise((r) => setTimeout(r));\n}\nfunction isChildKey(text) {\nreturn `ABCDEFGHIJKLMNOPRQSTUWXYZ`.includes(text.at(0));\n}\nfunction deepCopy(data) {\nif (Array.isArray(data)) {\nreturn data.reduce((prev, val) => [...prev, deepCopy(val)], []);\n}\nif (typeof data === `object`) {\nconst newObj = {};\nfor (const key in data) {\nnewObj[key] = deepCopy(data[key]);\n}\nreturn newObj;\n}\nreturn data;\n}\nfunction clone(obj, parent) {\nconst name = obj.name;\nlet newName = name;\nlet i = 0;\nwhile (parent[newName]) {\nnewName = `${name}${i}`;\ni++;\n}\nparent[newName] = new GameObject({ ...obj.props, parent });\n}\nfunction loadScene({ name, ...newScene }) {\ngameObjects.length = 0;\nsetScene(new GameObject(deepCopy(newScene)), name);\nfor (const key in events)\ndelete events[key];\nfor (const key in eventsHover)\ndelete eventsHover[key];\n}\nfunction draw({ text, color, x, y, w, h, ...props }) {\nctx.save();\nfor (const key in props) {\nctx[key] = props[key];\n}\nif (text)\nctx.fillText(text, x, y);\nif (color) {\nctx.fillStyle = color;\nctx.fillRect(x, y, w, h);\n}\nctx.restore();\n}\nasync function run() {\nGameTime.set(1);\nrequestAnimationFrame(render);\nlet timer = performance.now();\nlet updates = 0;\nlet delta = 0;\nwhile (true) {\nconst now = performance.now();\ndelta += (now - GameTime.lastTime) / GameTime.ms;\nif (delta > 60)\ndelta = 60;\nGameTime.lastTime = now;\nwhile (delta >= 1) {\nupdate();\nupdates++;\ndelta--;\n}\nif (now - timer > 1000) {\ntimer += 1000;\nLog.updates = updates;\nLog.frames = Log.framesTemp;\nupdates = 0;\nLog.framesTemp = 0;\n}\nawait wait0();\n}\n}\nfunction update() {\nfor (const obj of gameObjects) {\nfor (const f of obj.toUpdate)\nf();\n}\nfor (const key in events)\ndelete events[key];\n}\nfunction render() {\nctx.fillStyle = `black`;\nctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\nfor (const obj of gameObjects) {\nfor (const f of obj.toRender)\nf();\n}\nconst props = {\nx: 8,\ny: 8,\nfillStyle: `white`,\nfont: `22px serif`,\ntextAlign: `left`,\ntextBaseline: `top`\n};\ndraw({ text: `Update ${Log.updates}`, ...props });\ndraw({ text: `Render ${Log.frames}`, ...props, y: 38 });\nLog.framesTemp++;\nrequestAnimationFrame(render);\n}\nconsole.log(files, clone);\nloadScene(`REPLACE_PATH_TO_MAIN_SCENE`);\nrun();'.replace("`REPLACE_FILES`",function e(n,t,r){return Array.isArray(n)?"".concat(n.reduce((n,t)=>"".concat(n).concat(e(t),","),"[").slice(0,-1),"]"):"object"==typeof n?"".concat(Object.keys(n).reduce((t,r)=>"".concat(t).concat(r,":").concat(e(n[r],r,n.type),","),"{").slice(0,-1),"}"):"gameObject"===r&&y(t)?n:JSON.stringify(n)}(D.value)).replace("`REPLACE_PATH_TO_MAIN_SCENE`",R.pathToMainScene))}function ec(){P.value=el()}function eu(){x("".concat(R.gameName,".virginengine"),JSON.stringify({conf:R,files:D.value}))}function ed(){return(0,r.jsx)(J,{text:"Config",childs:Object.keys(R).filter(e=>"type"!==e).map(e=>({text:e,object:R,access:e}))})}window.addEventListener("keydown",e=>{e.ctrlKey&&"s"===e.key&&(e.preventDefault(),eu())});let ef={Test:ec,Save:eu,Build:function(){x("".concat(R.gameName,".html"),el(),!0)},Load:N,Config:()=>M.value=(0,r.jsx)(ed,{})};function em(){return M.bind(),M.value}function eh(){return(0,r.jsx)(i,{name:"Inspenctor",className:"row-span-2 w-(--width3) border-l-1 border-solid border-zinc-400",headerOptions:ef,children:(0,r.jsx)("div",{className:"p-2 overflow-y-scroll",children:(0,r.jsx)(em,{})})})}function ep(e){let{old:n,file:t,name:s,deep:o=0,path:i="files"}=e,a=0===o;a||(i+=".".concat(s));let l="folder"===t.type,[u,d]=F(a,l),f=d.value&&"scene"!==t.type&&Object.entries(t).map(e=>{let[n,s]=e;return b(n)&&(0,r.jsx)(ep,{old:t,file:s,name:n,deep:o+1,path:i},n)});return c({deep:o,name:s,arrow:u,childsElement:f,onClick:()=>{M.value=(0,r.jsxs)("div",{className:"m-3",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"File"}),(0,r.jsxs)("div",{children:["Type: ",t.type]}),(0,r.jsxs)("div",{children:["Name: ",s]})]})},onContextMenu:e=>{let{pageX:r,pageY:o}=e,c=(e,n)=>[()=>_.value=[e=>{t[e]={type:n},d.value=!0,D.refresh()}],e,l];H.value=[r,o,c("New file","txt"),c("New folder","folder"),c("New scene","scene"),[()=>_.value=[e=>{s!==e&&(delete n[s],n[e]=t,D.refresh())},s],"Rename",!a],[()=>navigator.clipboard.writeText(i),"Copy path"],[()=>{delete n[s],D.refresh()},"Delete",!a]]},onMouseDown:()=>{a||(G.value={from:"files",old:n,file:t,name:s})},onMouseUp:()=>{if(!l)return;let e=G.value;(null==e?void 0:e.from)!=="files"||e.name===s||t[e.name]||(t[e.name]=e.file,e.old&&delete e.old[e.name],D.refresh())},onDoubleClick:()=>"scene"===t.type&&void(z.value=t)})}let ev=()=>(D.bind(),(0,r.jsx)(ep,{file:D.value,name:"files",deep:0,old:!0}));function ex(){return(0,r.jsx)(i,{name:"Files",className:"w-(--width2) h-(--height2)",children:(0,r.jsx)("div",{className:"overflow-y-scroll",children:(0,r.jsx)(ev,{})})})}function eb(e){return(0,r.jsx)("input",{className:"mx-auto my-6 border-4 border-solid border-zinc-400 px-16 py-4 text-5xl cursor-pointer hover",type:"button",...e})}function ej(){return U.bind(),U.value?null:(0,r.jsxs)("div",{className:"absolute z-1 w-screen h-screen flex flex-col justify-center bg-[#000a]",children:[(0,r.jsx)(eb,{value:"Load Project",onClick:()=>N()}),(0,r.jsx)(eb,{value:"New project",onClick:g})]})}function ey(){let e=(0,u.useRef)(null);return H.bind(),(0,u.useEffect)(()=>{function n(n){let{target:t}=n;e.current&&!e.current.contains(t)&&(H.value=[])}return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[e]),H.value.length>2?(0,r.jsx)("div",{ref:e,className:"absolute z-1 border-4 border-solid border-zinc-800 px-2 py-0.5 bg-black",style:{inset:"".concat(H.value[1],"px auto auto ").concat(H.value[0],"px")},children:H.value.slice(2).map(e=>{let[n,t,s=!0]=e;return s?(0,r.jsx)("div",{className:"cursor-pointer hover",onClick:()=>{n(),H.value=[]},children:t},t):null})}):null}function eg(){let e=(0,u.useRef)(null),n=function(e){_.bind();let[n,t="",r=!1]=_.value,s=()=>{n&&j(t)&&n(r?"".concat(t[0].toLowerCase()).concat(t.slice(1)):t),_.value=[]};return(0,u.useEffect)(()=>{if(e)return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n);function n(n){let{target:t}=n;e.current&&!e.current.contains(t)&&s()}}),n?{value:t,onChange:e=>{let{target:t}=e,s=k(t.value);j(s)&&(_.value=[n,s,r])},onKeyDown:e=>{let{key:n}=e;return"Enter"===n&&s()}}:null}(e);return n&&(0,r.jsx)("input",{ref:e,type:"text",className:"absolute z-1 text-4xl translate-x-[calc(50vw-50%)] translate-y-[calc(50vh-50%)]",...n,autoFocus:!0})}let ew=m(void 0);function ek(e){let{clientX:n,clientY:t,buttons:r}=e;1===r&&(console.log("Render"),ew.value={left:n+3,top:t+3})}function eO(){G.value=null,ew.value=void 0}function eN(){var e;return G.bind(),ew.bind(),(0,u.useEffect)(()=>{if(G.value)return window.addEventListener("mousemove",ek),window.addEventListener("mouseup",eO),()=>{window.removeEventListener("mousemove",ek),window.removeEventListener("mouseup",eO)}}),ew.value?(0,r.jsx)("div",{className:"absolute z-1 bg-[#000a]",style:ew.value,children:null==(e=G.value)?void 0:e.name}):null}let eE=["16/9","1/1","9/16"],eC=m(eE[0]);function eS(){if(P.bind(console.clear),eC.bind(),P.value)return(0,r.jsx)(i,{name:"Test",className:"absolute z-1 w-screen h-screen",headerOptions:{...eE.reduce((e,n)=>({...e,[n]:()=>eC.value=n}),{}),Restart:()=>{P.value=".",setTimeout(ec)},Exit:()=>P.value=""},children:(0,r.jsx)("div",{className:"flex justify-center bg-zinc-950",children:(0,r.jsx)("iframe",{title:"scene",className:"border-x-1 border-solid border-zinc-400",style:{height:"min(100%, 100vw * ".concat(eC.value,")"),aspectRatio:eC.value},srcDoc:P.value})})})}function eA(){if(function(){let[e,n]=(0,u.useState)(!1);return(0,u.useEffect)(()=>n(!0),[e]),e}())return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{children:[(0,r.jsx)(ej,{}),(0,r.jsx)(ey,{}),(0,r.jsx)(eg,{}),(0,r.jsx)(eN,{}),(0,r.jsx)(eS,{})]}),(0,r.jsxs)("main",{className:"w-screen h-screen grid grid-cols-[30fr_30fr_40fr] grid-rows-[55fr_45fr]",children:[(0,r.jsx)(l,{}),(0,r.jsx)(ei,{}),(0,r.jsx)(eh,{}),(0,r.jsx)(ex,{})]})]})}},6928:(e,n,t)=>{Promise.resolve().then(t.bind(t,3914))}},e=>{var n=n=>e(e.s=n);e.O(0,[441,684,358],()=>n(6928)),_N_E=e.O()}]);