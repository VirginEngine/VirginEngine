(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";e.s(["default",()=>eC],52683);var t=e.i(43476);let n=function(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=function e(t){var n,r,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t)if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(r=e(t[n]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}(e))&&(r&&(r+=" "),r+=t);return r};function r(e){let{name:r,headerOptions:i,className:a,children:o}=e;return(0,t.jsxs)("section",{className:n("grid grid-rows-[24px_1fr]",a),children:[(0,t.jsx)(s,{name:r,options:i}),o]})}function s(e){let{name:n,options:r}=e;return(0,t.jsxs)("div",{className:"border-b-1 border-zinc-400 px-2 flex bg-black",children:[(0,t.jsx)("span",{className:"mr-auto font-bold",children:n}),r&&Object.keys(r).map(e=>(0,t.jsx)("input",{type:"button",className:"my-auto mx-2 cursor-pointer hover",value:e,onClick:r[e]},e))]})}function i(){return(0,t.jsx)("div",{className:"p-0.75 overflow-y-scroll select-text",children:"Coming soon!"})}function a(){return(0,t.jsx)(r,{name:"Docs",className:"row-span-2 w-(--width1) border-r-1 border-zinc-400",children:(0,t.jsx)(i,{})})}function o(e){let{deep:n,arrow:r,name:s,childsElement:i,...a}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex",style:{marginLeft:8*n},children:[r,(0,t.jsx)("div",{className:"cursor-pointer hover",...a,children:s})]}),i]})}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=e.i(71645);function u(){let e=(0,l.useState)(!1)[1];return()=>e(e=>!e)}class d{bind(e){if(e){let t=u();this.refresh=()=>{e(),t()}}else this.refresh=u()}get value(){return this.v}set value(e){var t;this.v=e,null==(t=this.refresh)||t.call(this)}constructor(e){c(this,"v",void 0),c(this,"refresh",()=>{throw Error("Refresh not bind!")}),this.v=e}}function f(e){return new d(e)}function h(e,t){var n;let r=(n=new d(e),(0,l.useState)(n)[0]);return r.bind(t),r}function m(e){return JSON.parse(JSON.stringify(e))}function p(e){let{name:t,...n}=e,r=document.createElement(t);for(let e in n)r[e]=n[e];r.click()}function x(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];p({name:"a",href:"data:text;charset=utf-8,".concat(n?encodeURIComponent(t):t),download:e})}function v(e){return S.toUpperCase().includes(e[0])}function y(e){if(0===e.length||!v(e))return!1;for(let t of e)if(!C.includes(t.toLowerCase()))return!1;return!0}function j(e){return!v(e)&&!A.includes(e)}function b(){G.value=!0,z.value=R.pathToMainScene.split(".").slice(1).reduce((e,t)=>e[t],D.value)}function g(){let{position:e,rotation:t,scale:n,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(r).reduce((e,t)=>({[t]:r[t],...e}),{type:"gameObject",transform:{position:e||{x:0,y:0},rotation:t||{z:0},scale:n||{x:1,y:1}}})}function w(e){return 0===e.length||e[0]===e[0].toUpperCase()?e:"".concat(e[0].toUpperCase()).concat(e.slice(1))}function O(e,t){for(let t in e)delete e[t];for(let n in t)e[n]=t[n]}function k(){p({name:"input",type:"file",accept:".virginengine",onchange:e=>{let{target:t}=e,n=new FileReader;n.onload=e=>{let{target:t}=e,n=JSON.parse(t.result);O(R,n.conf),O(D.value,n.files),b()},n.readAsText(t.files[0])}})}function N(e){return"string"!=typeof e?typeof e:Array.isArray(e)||"["===e[0]?"array":"{"===e[0]?"object":0===e.indexOf("function")?"function":(['"',"'","`"].includes(e[0]),"string")}let S="abcdefghijklmnoprqstuwxyz",E="0123456789",C="".concat(S).concat(E,"_"),A=["type","transform","position","rotation","scale","text","rect","sprite"],R={gameName:"NameOfGame",version:"0.0.0",author:"YourNick",description:"Description",fullScreen:!0,pathToMainScene:"files.Scenes.DefaultScene"},T={type:"folder",Scenes:{type:"folder",MenuScene:{type:"scene",name:"MenuScene"},MainScene:{type:"scene",name:"MainScene"},DefaultScene:{name:"DefaultScene",type:"scene",Parent:g({start:"function() {\n  for(let i = 0; i < 1000; i++)\n    setTimeout(() => this.parent.Child.clone(scene))\n}"}),Child:g({scale:{x:20,y:20},sprite:{color:"#974",imagePath:""},start:"function() {\n  this.position = {x: Math.random() * window.innerWidth, y: Math.random() * window.innerHeight}\n}",update:"function() {\n  const x = this.position.x - 1\n  this.position = {x: x < 0 ? window.innerWidth : x, y: this.position.y}\n}"})}},Assets:{type:"folder",ExampleImage:{type:"image",value:{src:"data:image/png;base64",width:1,height:1}}}},z=f(T.Scenes.MainScene),L=f(null),P=f([]),M=f(null),U=f(""),D=f(T),_=f([]),G=f(!1);function H(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=h(e);return[n?(0,t.jsx)("div",{className:"w-6 h-6 text-center justify-self-center rounded-full cursor-pointer hover",style:{transform:"rotate(".concat(90*!!r.value,"deg)")},onClick:()=>r.value=!r.value,children:">"}):(0,t.jsx)("div",{className:"w-6 h-6"}),r]}function F(){let e=(0,l.useState)(!1)[1];return()=>e(e=>!e)}function B(e){let{sig:r}=e;return(0,t.jsx)("input",{type:"checkbox",className:n("w-5 h-5 my-auto accent-green-600 cursor-pointer",!r.value&&"opacity-20"),checked:r.value,onChange:e=>{let{target:t}=e;return r.value=t.checked}})}function I(e){let{sig:n}=e,r=h(String(n.value));return(0,t.jsx)("input",{type:"text",className:"w-full border-b-1 border-zinc-400 accent-green-600",value:r.value,onChange:e=>{let{target:{value:t}}=e,s=!1;for(let e of t){if(!"".concat(E,"-.").includes(e))return;if("."===e){if(s)return;s=!0}}let i=t.slice(1).includes("-")?-Number("".concat(t.at(0)).concat(t.slice(1).replaceAll("-",""))):Number(t);if(i||0===i){n.value=i,r.value=String(i);return}r.value=t}})}function K(e){let{sig:n}=e;return(0,t.jsx)("input",{type:"text",className:"w-full border-b-1 border-zinc-400 accent-green-600",value:n.value,onChange:e=>{let{target:t}=e;return n.value=t.value}})}function J(e){let{object:n,access:r,type:s}=e,i=h(n[r],()=>n[r]=i.value),a=s||N(i.value),o=function(e,n){switch(e){case"boolean":return(0,t.jsx)(B,{...n});case"number":return(0,t.jsx)(I,{...n});case"string":return(0,t.jsx)(K,{...n});case"array":case"object":case"function":case"enum":return null}}(a,{sig:i});return(0,t.jsxs)("div",{className:"w-full grid grid-cols-[auto_1fr] gap-3",children:[(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("span",{children:r.slice(1).split("").reduce((e,t)=>"".concat(e).concat(t===t.toUpperCase()?" ":"").concat(t),r[0].toUpperCase())}),(0,t.jsxs)("span",{className:"text-green-500",children:[": ",a]}),(0,t.jsx)("span",{children:"="})]}),o]})}function $(e){let{text:n,remove:r,childs:s,element:i}=e;return(0,t.jsxs)("div",{className:"mt-4 border-b-2 border-zinc-950 pb-2",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("h2",{className:"mb-2 border-l-4 border-zinc-800 pl-2 text-2xl font-bold",children:n}),r?(0,t.jsx)("input",{type:"button",value:"Remove",className:"mr-4 ml-auto cursor-pointer hover",onClick:r}):null]}),null==s?void 0:s.map(e=>(0,t.jsx)(J,{...e},e.access)),i]})}function q(e){var n;let{object:r,access:s}=e,i=(n=N(r[s]),(0,l.useState)(n)[0]);return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("div",{children:s}),(0,t.jsxs)("div",{className:"text-green-500",children:[": ",i]}),(0,t.jsx)("div",{children:"="})]}),(0,t.jsx)(W,{object:r,access:s})]})}function W(e){var n;let{object:r,access:s}=e,i=(0,l.useRef)(null),a=F();return(0,l.useEffect)(a,[i]),(0,t.jsx)("textarea",{ref:i,className:"w-full resize-none",style:{height:null==i||null==(n=i.current)?void 0:n.scrollHeight},value:r[s],onChange:e=>{let{target:t}=e;r[s]=t.value,a()}})}window.oncontextmenu=e=>e.preventDefault();let Y={boolean:[!1,J],number:[0,J],string:['""',J],array:['[12, 43, "foo"]',q,"[","]"],object:["{}",q,"{","}"],function:["function() {}",q,"function(",") {","}"]};function Q(e){let{object:n,value:r,refresh:s}=e;return(0,t.jsx)(ee,{text:w(r),onClick:()=>P.value=[e=>{!function(e,t){for(let n in e)if(n===t)return!0;return!1}(n,e)&&(n[e]=Y[r][0],s())},"",!0]})}function X(e){let{object:n,refresh:r}=e;return(0,t.jsxs)(t.Fragment,{children:[Object.keys(n).filter(e=>j(e)).map(e=>(0,t.jsx)($,{text:e,element:Y[N(n[e])][1]({object:n,access:e}),remove:()=>{delete n[e],r()}},e)),(0,t.jsx)("div",{className:"mb-4 flex flex-wrap",children:Object.keys(Y).map(e=>(0,t.jsx)(Q,{value:e,object:n,refresh:r},e))})]})}function Z(e){let{object:n}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($,{text:"Position",childs:[{object:n.transform.position,access:"x"},{object:n.transform.position,access:"y"}]}),(0,t.jsx)($,{text:"Rotation",childs:[{object:n.transform.rotation,access:"z"}]}),(0,t.jsx)($,{text:"Scale",childs:[{object:n.transform.scale,access:"x"},{object:n.transform.scale,access:"y"}]})]})}let V={text:[[["value"]],{value:""},["rect"],[]],rect:[[["x"],["y"]],{x:0,y:0},[],["text"]],sprite:[[["color"],["imagePath"]],{color:"",imagePath:""},[],[]]};function ee(e){let{text:n,onClick:r}=e;return(0,t.jsx)("input",{type:"button",value:"+ ".concat(n),className:"mt-3 mb-6 px-3 py-2 cursor-pointer hover",onClick:r})}function et(e){var n;let{name:r,refresh:s,readOnly:i,...a}=e;return a.object[r]?(0,t.jsx)($,{text:w(r),childs:(n=a.object,V[r][0].reduce((e,t)=>[...e,{object:t.slice(0,-1).reduce((e,t)=>e[t],n[r]),access:t.at(-1)}],[])),...a,remove:i?void 0:()=>{for(let e of V[r][3])delete a.object[e];delete a.object[r],s()}},r):(0,t.jsx)(ee,{text:w(r),onClick:()=>{if(!i){for(let e of(a.object[r]=m(V[r][1]),V[r][2]))a.object[e]||(a.object[e]=m(V[e][1]));s()}}})}function en(e){let{name:n,...r}=e,s=F();return r={...r,refresh:s},(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"ml-3 text-xl font-bold",children:n}),(0,t.jsx)(Z,{object:r.object}),Object.keys(V).map(e=>(0,l.createElement)(et,{...r,key:e,name:e})),(0,t.jsx)(X,{object:r.object,refresh:s})]},JSON.stringify(r))}function er(e){var n;let{old:r,name:s,object:i,deep:a=0}=e,c=0===a,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((t,n)=>!A.includes(n)&&v(n)?{[n]:e[n],...t}:t,{})}(i),[u,d]=H(c,(null==(n=Object.keys(l))?void 0:n.length)>0),f=d.value&&Object.entries(l).map(e=>{let[n,r]=e;return(0,t.jsx)(er,{old:i,object:r,name:n,deep:a+1},n)});return o({deep:a,name:s,arrow:u,childsElement:f,onClick:()=>{var e;return!c&&(e={old:r,object:i,name:s},void(L.value=(0,t.jsx)(en,{...e})))},onContextMenu:e=>{let{pageX:t,pageY:n}=e;_.value=[t,n,[()=>{P.value=[e=>{Object.keys(i).includes(e)||(i[e]=g(),d.value=!0,z.refresh())}]},"New Object"],[()=>{P.value=[e=>{s===e||r[e]||(delete r[s],r[e]=i,z.refresh())},s]},"Rename",!c],[()=>{delete r[s],z.refresh()},"Delete",!c]]},onMouseDown:()=>{c||(M.value={from:"hierarchy",old:r,file:i,name:s})},onMouseUp:()=>{let e=M.value;if(e&&e.name!==s&&"gameObject"===e.file.type){for(let t in l)if(t===e.name)return;i[e.name]=e.file,"hierarchy"===e.from&&e.old&&delete e.old[e.name],z.refresh()}}})}function es(){return z.bind(()=>L.value=null),(0,t.jsx)(er,{object:z.value,old:D.value.Scenes,name:z.value.name,deep:0})}function ei(){return(0,t.jsx)(r,{name:"Hierarchy",className:"w-(--width2) h-(--height1) border-b-1 border-zinc-400",children:(0,t.jsx)("div",{className:"overflow-y-scroll",children:(0,t.jsx)(es,{})})})}let ea='\n<!DOCTYPE html>\n<html lang="en">\n  <head>\n    <meta charset="UTF-8"/>\n    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>\n    <meta name="author" content="AUTHOR"/>\n    <meta name="description" content="DESCRIPTION"/>\n    <meta name="keywords" content="GAME_NAME,AUTHOR"/>\n\n    <title>GAME_NAME</title>\n\n    <style>\n      body {\n        background-color:black;\n        margin:0;\n        border:0;\n        user-select:none;\n        width:100vw;\n        height:100vh;\n        overflow:hidden;\n      }\n    </style>\n  </head>\n  <body>\n    <canvas></canvas>\n    <script>\n      SCRIPT\n    </script>\n  </body>\n</html>\n'.replaceAll("\n"," ").replaceAll(/\s{2,}/g," ").replaceAll("> ",">").replaceAll(" <","<").replaceAll("; ",";").replaceAll(" {","{").replaceAll("{ ","{").replaceAll(' "','"').replaceAll('" ','"');function eo(){return ea.replaceAll("AUTHOR",R.author).replaceAll("DESCRIPTION",R.description).replaceAll("GAME_NAME",R.gameName).replaceAll("SCRIPT",'class Transform {gameObject;px = 0;py = 0;rz = 0;sx = 1;sy = 1;constructor(props, gameObject) {if (props && gameObject) {this.gameObject = gameObject;const { position, rotation, scale } = props;if (position)this.position = position;if (rotation)this.rotation = rotation;if (scale)this.scale = scale;gameObject.position = this.position;gameObject.rotation = this.rotation;gameObject.scale = this.scale;} else {this.readonly = true;}}get position() {return { x: this.px, y: this.py };}set position({ x, y }) {if (this.readonly)throw alert(`PROGRAMMER, you can\'t chage "readOnly" position`);for (const child of this.gameObject.childs) {child.transform.position = {x: child.transform.px - this.px + x,y: child.transform.py - this.py + y};}this.px = x;this.py = y;}get rotation() {return { z: this.rz };}set rotation({ z }) {if (this.readonly)throw alert(`PROGRAMMER, you can\'t chage "readOnly" rotation`);while (z < 0) {z += 360;}while (z >= 360) {z -= 360;}for (const child of this.gameObject.childs) {let newRot = child.transform.rz - this.rz + z;if (newRot < 0) {newRot += 360;} else if (newRot > 360) {newRot -= 360;}child.transform.rotation = { z: newRot };}this.rz = z;}get scale() {return { x: this.sx, y: this.sy };}set scale({ x, y }) {if (this.readonly)throw alert(`PROGRAMMER, you can\'t chage "readOnly" scale`);for (const child of this.gameObject.childs) {child.transform.scale = {x: child.transform.sx / this.sx * x,y: child.transform.sy / this.sy * y};}this.sx = x;this.sy = y;}get props() {return {position: this.position,rotation: this.rotation,scale: this.scale};}}async function wait(time) {await new Promise((r) => setTimeout(r, time));}function isChildKey(text) {return alphabet.includes(text.at(0));}function deepCopy(data) {if (Array.isArray(data)) {return data.reduce((prev, val) => [...prev, deepCopy(val)], []);}if (typeof data === `object`) {const newObj = {};for (const key in data) {if ([`parent`, `toUpdate`, `toRender`, `gameObject`].includes(key))continue;newObj[key] = deepCopy(data[key]);}return newObj;}return data;}function loadScene({ name, ...newScene }) {scene.load(deepCopy(newScene), name);onresize();}function draw({ text, color, x, y, w, h, ...props }) {ctx.save();for (const key in props) {ctx[key] = props[key];}if (text)ctx.fillText(text, x, y);if (color) {ctx.fillStyle = color;ctx.fillRect(x, y, w, h);}ctx.restore();}function drawBoxMiddle(x, y, w, h, color) {draw({ x: x - w / 2, y: y - h / 2, w, h, color });}function onresize() {ctx.canvas.width = window.innerWidth;ctx.canvas.height = window.innerHeight;}function Sprite(props, gameObject) {if (props.imagePath)return new PathSprite(props, gameObject);return new BoxSprite(props, gameObject);}class BoxSprite {gameObject;color;constructor({ color }, gameObject) {this.gameObject = gameObject;this.color = color;gameObject.toRender.push(this.render.bind(this));}render() {drawBoxMiddle(this.gameObject.position.x, this.gameObject.position.y, this.gameObject.scale.x, this.gameObject.scale.y, this.color);}get props() {return {color: this.color};}}class PathSprite {gameObject;imagePath;constructor({ imagePath }, gameObject) {this.gameObject = gameObject;this.imagePath = imagePath;gameObject.toRender.push(this.render.bind(this));throw Error(`PathSprite, camming soon!`);}render() {}get props() {return {imagePath: this.imagePath};}}var textBaseline = [`top`, `middle`, `bottom`];var textAlign = [`left`, `center`, `right`];class Text {value;rect;transform;textBaseline;textAlign;constructor({ value }, gameObject) {this.transform = gameObject.transform;this.value = value;if (gameObject.rect) {this.rect = gameObject.rect;this.textBaseline = textBaseline[this.rect.x];this.textAlign = textAlign[this.rect.y];}gameObject.toRender.push(this.render.bind(this));}render() {draw({text: this.value,...this.transform.position,fillStyle: `white`,font: `${this.transform.scale.y}px serif`,textBaseline: this.textBaseline,textAlign: this.textAlign});}get props() {return {value: this.value};}}var keywords = [`toUpdate`, `toRender`, `parent`, `position`, `rotation`, `scale`];class GameObject {toUpdate = [];toRender = [];parent;name;start;update;transform;position;rotation;scale;rect;text;sprite;constructor({ parent, transform, rect, text, sprite, start, update, render, ...rest }, name) {this.name = name;this.parent = parent || {};if (parent)this.parent[this.name] = this;this.transform = new Transform(transform, this);if (rect)this.rect = rect;if (text)this.text = new Text(text, this);if (sprite)this.sprite = Sprite(sprite, this);for (const key in rest) {this[key] = isChildKey(key) ? new GameObject({ ...rest[key], parent: this }, key) : typeof rest[key] === `function` ? rest[key].bind(this) : rest[key];}if (update) {this.update = update;this.toUpdate.push(() => this.update.bind(this)());}if (render)this.toRender.push(() => render.bind(this)());if (start) {this.start = start;this.start.bind(this)();}gameObjects.push(this);}get childs() {return Object.keys(this).reduce((prev, key) => isChildKey(key) ? [...prev, this[key]] : prev, []);}get props() {const newObj = {start: this?.start,update: this?.update,transform: this.transform.props,rect: deepCopy(this.rect),sprite: this.sprite?.props,text: this.text?.props};for (const key in this) {if (!(key in newObj) && !keywords.includes(key))newObj[key] = this[key];}return deepCopy(newObj);}clone(parent = this.parent) {const name = this.name;let newName = name;let i = 0;while (parent[newName]) {newName = `${name}${i}`;i++;}new GameObject({ ...this.props, parent }, newName);}destroy() {for (const child of this.childs)child.destroy();const { parent } = this;const parentKey = this.name;for (const key in this)delete this[key];gameObjects.splice(gameObjects.indexOf(this));delete parent[parentKey];}}var ctx = document.body.children[0].getContext(`2d`);var files = `REPLACE_FILES`;var alphabet = `ABCDEFGHIJKLMNOPRQSTUWXYZ`;var events = {};var eventsHover = {};var gameObjects = [];var Log = { updates: 0, frames: 0, framesTemp: 0 };var GameTime = {ms: 1,value: 1,lastTime: 0,set(newTime) {this.value = newTime;this.ms = 1000 / (60 * this.value);this.lastTime = performance.now();}};class Scene extends GameObject {camera = { x: 0, y: 0 };constructor(scene2, name) {super(scene2, name);}load(newScene, name) {this.close();scene = new Scene(newScene, name);}close() {super.destroy();gameObjects.length = 0;for (const key in events)delete events[key];for (const key in eventsHover)delete eventsHover[key];for (const key in this) {if (![`name`, `objects`, `load`, `close`].includes(key))delete this[key];}}}var scene = new Scene({}, ``);async function run() {loadScene(`REPLACE_PATH_TO_MAIN_SCENE`);GameTime.set(1);requestAnimationFrame(render);let timer = performance.now();let updates = 0;let delta = 0;while (true) {const now = performance.now();delta += (now - GameTime.lastTime) / GameTime.ms;if (delta > 60)delta = 60;GameTime.lastTime = now;while (delta >= 1) {update();updates++;delta--;}if (now - timer > 1000) {timer += 1000;Log.updates = updates;Log.frames = Log.framesTemp;updates = 0;Log.framesTemp = 0;}await wait();}}function update() {for (const obj of gameObjects) {for (const f of obj.toUpdate)f();}for (const key in events)delete events[key];}function render() {ctx.fillStyle = `black`;ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);for (const obj of gameObjects) {for (const f of obj.toRender)f();}draw({text: `${gameObjects.length}go, ${Log.updates}ups, ${Log.frames}fps`,x: window.innerWidth - 6,y: 6,fillStyle: `white`,font: `18px serif`,textAlign: `right`,textBaseline: `top`});Log.framesTemp++;requestAnimationFrame(render);}window.addEventListener(`mousedown`, () => eventsHover.click = true);window.addEventListener(`mouseup`, () => delete eventsHover.click);window.addEventListener(`click`, () => events.click = true);window.addEventListener(`keydown`, ({ key }) => events[key] = eventsHover[key] = true);window.addEventListener(`keyup`, ({ key }) => delete eventsHover[key]);window.addEventListener(`contextmenu`, (e) => {e.preventDefault();!document.fullscreenElement ? document.documentElement.requestFullscreen() : document.exitFullscreen();});window.addEventListener(`resize`, onresize);console.log(`Engine:`, !!files);onresize();run();'.replace("`REPLACE_FILES`",function e(t,n,r){return Array.isArray(t)?"".concat(t.reduce((t,n)=>"".concat(t).concat(e(n),","),"[").slice(0,-1),"]"):"object"==typeof t?"".concat(Object.keys(t).reduce((n,r)=>"".concat(n).concat(r,":").concat(e(t[r],r,t.type),","),"{").slice(0,-1),"}"):"gameObject"===r&&j(n)?t:JSON.stringify(t)}(D.value)).replace("`REPLACE_PATH_TO_MAIN_SCENE`",R.pathToMainScene))}function ec(){U.value=eo()}function el(){x("".concat(R.gameName,".virginengine"),JSON.stringify({conf:R,files:D.value}))}function eu(){return(0,t.jsx)($,{text:"Config",childs:Object.keys(R).filter(e=>"type"!==e).map(e=>({text:e,object:R,access:e}))})}window.addEventListener("keydown",e=>{e.ctrlKey&&"s"===e.key&&(e.preventDefault(),el())});let ed={Test:ec,Save:el,Build:function(){x("".concat(R.gameName,".html"),eo(),!0)},Load:k,Config:()=>L.value=(0,t.jsx)(eu,{})};function ef(){return L.bind(),L.value}function eh(){return(0,t.jsx)(r,{name:"Inspenctor",className:"row-span-2 w-(--width3) border-l-1 border-zinc-400",headerOptions:ed,children:(0,t.jsx)("div",{className:"p-2 overflow-y-scroll",children:(0,t.jsx)(ef,{})})})}function em(e){let{old:n,file:r,name:s,deep:i=0,path:a="files"}=e,c=0===i;c||(a+=".".concat(s));let l="folder"===r.type,[u,d]=H(c,l),f=d.value&&"scene"!==r.type&&Object.entries(r).map(e=>{let[n,s]=e;return v(n)&&(0,t.jsx)(em,{old:r,file:s,name:n,deep:i+1,path:a},n)});return o({deep:i,name:s,arrow:u,childsElement:f,onClick:()=>{L.value=(0,t.jsxs)("div",{className:"m-3",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"File"}),(0,t.jsxs)("div",{children:["Type: ",r.type]}),(0,t.jsxs)("div",{children:["Name: ",s]})]})},onContextMenu:e=>{let{pageX:t,pageY:i}=e,o=(e,t)=>[()=>P.value=[e=>{r[e]={type:t},d.value=!0,D.refresh()}],e,l];_.value=[t,i,o("New file","txt"),o("New folder","folder"),o("New scene","scene"),[()=>P.value=[e=>{s!==e&&(delete n[s],n[e]=r,D.refresh())},s],"Rename",!c],[()=>navigator.clipboard.writeText(a),"Copy path"],[()=>{delete n[s],D.refresh()},"Delete",!c]]},onMouseDown:()=>{c||(M.value={from:"files",old:n,file:r,name:s})},onMouseUp:()=>{if(!l)return;let e=M.value;(null==e?void 0:e.from)!=="files"||e.name===s||r[e.name]||(r[e.name]=e.file,e.old&&delete e.old[e.name],D.refresh())},onDoubleClick:()=>"scene"===r.type&&void(z.value=r)})}let ep=()=>(D.bind(),(0,t.jsx)(em,{file:D.value,name:"files",deep:0,old:!0}));function ex(){return(0,t.jsx)(r,{name:"Files",className:"w-(--width2) h-(--height2)",children:(0,t.jsx)("div",{className:"overflow-y-scroll",children:(0,t.jsx)(ep,{})})})}function ev(e){return(0,t.jsx)("input",{className:"mx-auto my-6 border-4 border-zinc-400 px-16 py-4 text-5xl cursor-pointer hover",type:"button",...e})}function ey(){return G.bind(),G.value?null:(0,t.jsxs)("div",{className:"absolute z-1 w-screen h-screen flex flex-col justify-center bg-[#000a]",children:[(0,t.jsx)(ev,{value:"Load Project",onClick:()=>k()}),(0,t.jsx)(ev,{value:"New project",onClick:b})]})}function ej(){let e=(0,l.useRef)(null);return _.bind(),(0,l.useEffect)(()=>{function t(t){let{target:n}=t;e.current&&!e.current.contains(n)&&(_.value=[])}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[e]),_.value.length>2?(0,t.jsx)("div",{ref:e,className:"absolute z-1 border-4 border-zinc-800 px-2 py-0.5 bg-black",style:{inset:"".concat(_.value[1],"px auto auto ").concat(_.value[0],"px")},children:_.value.slice(2).map(e=>{let[n,r,s=!0]=e;return s?(0,t.jsx)("div",{className:"cursor-pointer hover",onClick:()=>{n(),_.value=[]},children:r},r):null})}):null}function eb(){let e=(0,l.useRef)(null),n=function(e){P.bind();let[t,n="",r=!1]=P.value,s=()=>{t&&y(n)&&t(r?"".concat(n[0].toLowerCase()).concat(n.slice(1)):n),P.value=[]};return(0,l.useEffect)(()=>{if(e)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t);function t(t){let{target:n}=t;e.current&&!e.current.contains(n)&&s()}}),t?{value:n,onChange:e=>{let{target:n}=e,s=w(n.value);y(s)&&(P.value=[t,s,r])},onKeyDown:e=>{let{key:t}=e;return"Enter"===t&&s()}}:null}(e);return n&&(0,t.jsx)("input",{ref:e,type:"text",className:"absolute z-1 text-4xl translate-x-[calc(50vw-50%)] translate-y-[calc(50vh-50%)]",...n,autoFocus:!0})}let eg=f(void 0);function ew(e){let{clientX:t,clientY:n,buttons:r}=e;1===r&&(console.log("Render"),eg.value={left:t+3,top:n+3})}function eO(){M.value=null,eg.value=void 0}function ek(){var e;return M.bind(),eg.bind(),(0,l.useEffect)(()=>{if(M.value)return window.addEventListener("mousemove",ew),window.addEventListener("mouseup",eO),()=>{window.removeEventListener("mousemove",ew),window.removeEventListener("mouseup",eO)}}),eg.value?(0,t.jsx)("div",{className:"absolute z-1 bg-[#000a]",style:eg.value,children:null==(e=M.value)?void 0:e.name}):null}let eN={"16/9":"aspect-[16/9]","1/1":"aspect-square","9/16":"aspect-[9/16]"},eS=f(eN["16/9"]);function eE(){if(U.bind(console.clear),eS.bind(),U.value)return(0,t.jsx)(r,{name:"Test",className:"absolute z-1 w-screen h-screen",headerOptions:{...Object.entries(eN).reduce((e,t)=>{let[n,r]=t;return{...e,[n]:()=>eS.value=r}},{}),Restart:()=>{U.value=".",setTimeout(ec)},Exit:()=>U.value=""},children:(0,t.jsx)("div",{className:"flex justify-center bg-zinc-950",children:(0,t.jsx)("iframe",{title:"scene",className:n("box-content border-x-1 border-zinc-400",eS.value),srcDoc:U.value})})})}function eC(){if(function(){let[e,t]=(0,l.useState)(!1);return(0,l.useEffect)(()=>t(!0),[e]),e}())return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("header",{children:[(0,t.jsx)(ey,{}),(0,t.jsx)(ej,{}),(0,t.jsx)(eb,{}),(0,t.jsx)(ek,{}),(0,t.jsx)(eE,{})]}),(0,t.jsxs)("main",{className:"w-screen h-screen grid grid-cols-[30fr_30fr_40fr] grid-rows-[55fr_45fr]",children:[(0,t.jsx)(a,{}),(0,t.jsx)(ei,{}),(0,t.jsx)(eh,{}),(0,t.jsx)(ex,{})]})]})}}]);