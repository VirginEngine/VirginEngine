{"ast":null,"code":"import{useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export const File=_ref=>{let{old,file,name,main,deep=0}=_ref;const[open,setOpen]=useState(main&&true);const isFolder=file.type===`folder`;const onClick=()=>{window.editor.setInspector(/*#__PURE__*/_jsxs(\"div\",{style:{margin:12},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"File\"}),/*#__PURE__*/_jsx(\"div\",{children:`Type: ${file.type}`}),/*#__PURE__*/_jsx(\"div\",{children:`Name: ${name}`})]}));isFolder&&setOpen(!open);};const onContextMenu=_ref2=>{let{pageX,pageY}=_ref2;window.editor.setContextMenu({x:pageX,y:pageY,arr:[[`New file`,()=>{window.editor.setNameInput([``,newText=>{const[newName,extension=`txt`,...rest]=newText.split(`.`);if(!newName||rest.length>0){return;}file[newName]={type:extension};window.editor.reloadFiles();}]);},isFolder],[`New folder`,()=>{window.editor.setNameInput([``,newText=>{if(!window.editor.alphabet.includes(newText[0].toLowerCase())){return;}for(let i=1;i<newText.length;i++){if(!`${window.editor.alphabet}-_${window.editor.numbers}`.includes(newText[i].toLowerCase())){return;}}file[newText]={type:`folder`};window.editor.reloadFiles();}]);},isFolder],[`Rename`,()=>{window.editor.setNameInput([name,newText=>{if(name===newText){return;}if(old[newText]){console.error(`Error`);}else{delete old[name];old[newText]=file;window.editor.reloadFiles();}}]);}],[`Delete`,()=>{delete old[name];window.editor.reloadFiles();}]]});};const onMouseDown=()=>{window.editor.dragData={old,file,name};};const onMouseUp=()=>{const{dragData}=window.editor;if(main||!isFolder||dragData.name===name||file[dragData.name]){return;}file[dragData.name]=dragData.file;delete dragData.old[dragData.name];window.editor.dragData={};window.editor.reloadFiles();};return/*#__PURE__*/_jsxs(_Fragment,{children:[!main&&/*#__PURE__*/_jsxs(\"div\",{style:{cursor:`pointer`,marginLeft:deep*10,display:`flex`,flexDirection:`row`},onClick:onClick,onContextMenu:onContextMenu,onMouseDown:onMouseDown,onMouseUp:onMouseUp,children:[isFolder&&/*#__PURE__*/_jsx(\"div\",{style:{width:24,height:24,textAlign:`center`,justifySelf:`center`,borderRadius:12,transform:`rotate(${open?90:0}deg)`,transition:`transform 150ms`},children:`>`}),/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:file.type!==`folder`&&24},children:name})]}),isFolder&&open&&/*#__PURE__*/_jsx(_Fragment,{children:Object.entries(file).filter(_ref3=>{let[key]=_ref3;return key!==`type`;}).map(_ref4=>{let[key,value]=_ref4;return/*#__PURE__*/_jsx(File,{old:file,file:value,name:key,deep:deep+1},key);})})]});};","map":{"version":3,"names":["useState","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","File","_ref","old","file","name","main","deep","open","setOpen","isFolder","type","onClick","window","editor","setInspector","style","margin","children","onContextMenu","_ref2","pageX","pageY","setContextMenu","x","y","arr","setNameInput","newText","newName","extension","rest","split","length","reloadFiles","alphabet","includes","toLowerCase","i","numbers","console","error","onMouseDown","dragData","onMouseUp","cursor","marginLeft","display","flexDirection","width","height","textAlign","justifySelf","borderRadius","transform","transition","Object","entries","filter","_ref3","key","map","_ref4","value"],"sources":["/workspaces/deathengine/src/editor/files/File.jsx"],"sourcesContent":["import { useState } from \"react\"\n\nexport const File = ({ old, file, name, main, deep = 0 }) => {\n  const [open, setOpen] = useState(main && true)\n\n  const isFolder = file.type === `folder`\n\n  const onClick = () => {\n    window.editor.setInspector(<div\n      style={{\n        margin: 12\n      }}\n    >\n      <h2>File</h2>\n      <div>{`Type: ${file.type}`}</div>\n      <div>{`Name: ${name}`}</div>\n    </div>)\n    isFolder && setOpen(!open)\n  }\n\n  const onContextMenu = ({ pageX, pageY }) => {\n    window.editor.setContextMenu({\n      x: pageX,\n      y: pageY,\n      arr: [[`New file`, () => {\n        window.editor.setNameInput([``, (newText) => {\n          const [newName, extension = `txt`, ...rest] = newText.split(`.`)\n\n          if(!newName || rest.length > 0) {\n            return\n          }\n\n          file[newName] = {\n            type: extension\n          }\n\n          window.editor.reloadFiles()\n        }])\n      }, isFolder], [`New folder`, () => {\n        window.editor.setNameInput([``, (newText) => {\n          if(!window.editor.alphabet.includes(newText[0].toLowerCase())) {\n            return\n          }\n\n          for(let i = 1; i < newText.length; i++) {\n            if(!`${window.editor.alphabet}-_${window.editor.numbers}`.includes(newText[i].toLowerCase())) {\n              return\n            }\n          }\n\n          file[newText] = {\n            type: `folder`\n          }\n\n          window.editor.reloadFiles()\n        }])\n      }, isFolder], [`Rename`, () => {\n        window.editor.setNameInput([name, (newText) => {\n          if(name === newText) {\n            return\n          }\n\n          if(old[newText]) {\n            console.error(`Error`)\n          } else {\n            delete old[name]\n            old[newText] = file\n            window.editor.reloadFiles()\n          }\n        }])\n      }], [`Delete`, () => {\n        delete old[name]\n        window.editor.reloadFiles()\n      }]]\n    })\n  }\n\n  const onMouseDown = () => {\n    window.editor.dragData = {\n      old,\n      file,\n      name\n    }\n  }\n\n  const onMouseUp = () => {\n    const { dragData } = window.editor\n\n    if(main || !isFolder || dragData.name === name || file[dragData.name]) {\n      return\n    }\n\n    file[dragData.name] = dragData.file\n    delete dragData.old[dragData.name]\n    window.editor.dragData = {}\n    window.editor.reloadFiles()\n  }\n\n  return <>\n    {!main && <div\n      style={{\n        cursor: `pointer`,\n        marginLeft: deep * 10,\n        display: `flex`,\n        flexDirection: `row`\n      }}\n      onClick={onClick}\n      onContextMenu={onContextMenu}\n      onMouseDown={onMouseDown}\n      onMouseUp={onMouseUp}\n    >\n      {isFolder && <div\n        style={{\n          width: 24,\n          height: 24,\n          textAlign: `center`,\n          justifySelf: `center`,\n          borderRadius: 12,\n          transform: `rotate(${open ? 90 : 0}deg)`,\n          transition: `transform 150ms`\n        }}\n      >\n        {`>`}\n      </div>}\n      <div\n        style={{\n          marginLeft: file.type !== `folder` && 24\n        }}\n      >{name}</div>\n    </div>}\n    {isFolder && open && <>\n      {Object.entries(file).filter(([key]) => key !== `type`).map(([key, value]) => {\n        return <File\n          old={file}\n          file={value}\n          name={key}\n          key={key}\n          deep={deep + 1}\n        />\n      })}\n    </>}\n  </>\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}